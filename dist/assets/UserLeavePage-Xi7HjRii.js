import{n as A,p as J,c as D,q as K,s as O,P as R,x as j,d as q,o as w,i as E,w as s,g as t,e as a,f as l,t as _,h as e,_ as y,C as H,z as V,b as $,m as Y,F as B,l as N,k as C,D as P,K as X,L as G,r as M,j as Q,J as z}from"./index-xbrZr5yp.js";import{T as o}from"./index-aNXz6pB6.js";import{_ as L}from"./FormLabel.vue_vue_type_script_setup_true_lang-azPn_ecF.js";import{_ as F}from"./FormDatepicker.vue_vue_type_script_setup_true_lang-b70DNpH5.js";import{u as W}from"./useUser--D0eIaTK.js";import{u as Z}from"./useLeave-0BOm8sUl.js";function ee(f){const c=A({userId:"1",companyId:"1",startTime:"",endTime:"",restHours:0,leaveId:"",description:""}),{userId:b,companyId:h,startTime:u,endTime:m,restHours:v,leaveId:x,description:k}=J(c),g=D(()=>!!f);K(()=>{const p={};if(f){const i={...f,...p};Object.keys(c).forEach(d=>{i[d]!==void 0&&(c[d]=i[d])})}});const T=D(()=>b.value!==""&&h.value!==""&&u.value!==""&&m.value!==""&&x.value!==""&&v.value.toString()!=="");return{userId:b,companyId:h,startTime:u,endTime:m,restHours:v,leaveId:x,description:k,canSubmit:T,isEdit:g,submit:async(p,i)=>{const d=p?"update":"create";console.log(d),await{create:()=>j.post("/salary/user-leave",{...c}),update:()=>j.patch(`/salary/user-leave/${f.id}`,{...c,id:f.id})}[d](),O().showSaveSuccess(),i(),R().fetchUserLeaveList({companyId:"1",page:1})}}}const te={class:"relative mb-5 text-center text-xl"},se={class:"mb-4 flex items-center"},ae=["value"],le={class:"mb-4 flex items-center"},oe=["value"],de={class:"mb-4 flex items-center"},re={class:"mb-4 flex items-center"},ne={class:"mb-4 flex items-center"},ie={class:"mb-4 flex items-center"},ce={class:"flex justify-center"},ue=q({__name:"CreateUserLeaveModal",props:{userLeave:{},idx:{}},emits:["close"],setup(f,{emit:c}){const{users:b}=W(),{leaveList:h}=Z("1"),u=c,{userLeave:m}=f,{userId:v,startTime:x,endTime:k,leaveId:g,restHours:T,description:U,canSubmit:p,isEdit:i,submit:d}=ee(m);return(I,r)=>(w(),E(e(P),{open:!0,size:"md"},{default:s(()=>[t(e(P).Panel,{class:"p-4 md:w-[600px]"},{default:s(()=>[a("div",te,[l(_(e(i)?"請假申請"+(I.idx+1):"請假申請")+" ",1),t(e(y),{icon:"X",class:"absolute right-0 top-0 cursor-pointer text-[#939393]",onClick:r[0]||(r[0]=()=>u("close"))})]),a("section",null,[a("div",se,[t(e(L),{class:"w-[120px]"},{default:s(()=>[l("選擇員工 *")]),_:1}),t(e(H),{class:"flex-1",type:"text",modelValue:e(v),"onUpdate:modelValue":r[1]||(r[1]=n=>V(v)?v.value=n:null)},{default:s(()=>[(w(!0),$(B,null,Y(e(b),(n,S)=>(w(),$("option",{key:S,value:n.id},_(n.name),9,ae))),128))]),_:1},8,["modelValue"])]),a("div",le,[t(e(L),{class:"w-[120px]"},{default:s(()=>[l("假別 *")]),_:1}),t(e(H),{class:"flex-1",modelValue:e(g),"onUpdate:modelValue":r[2]||(r[2]=n=>V(g)?g.value=n:null)},{default:s(()=>[(w(!0),$(B,null,Y(e(h),(n,S)=>(w(),$("option",{key:S,value:n.id},_(n.name),9,oe))),128))]),_:1},8,["modelValue"])]),a("div",de,[t(e(L),{class:"w-[120px]"},{default:s(()=>[l("起始時間 *")]),_:1}),t(F,{class:"flex-1",modelValue:e(x),"onUpdate:modelValue":r[3]||(r[3]=n=>V(x)?x.value=n:null),"auto-apply":"",detail:""},null,8,["modelValue"])]),a("div",re,[t(e(L),{class:"w-[120px]"},{default:s(()=>[l("結束時間 *")]),_:1}),t(F,{class:"flex-1",modelValue:e(k),"onUpdate:modelValue":r[4]||(r[4]=n=>V(k)?k.value=n:null),"auto-apply":"",detail:""},null,8,["modelValue"])]),a("div",ne,[t(e(L),{class:"w-[120px]"},{default:s(()=>[l("休息時間 (小時) *")]),_:1}),t(e(N),{class:"flex-1",type:"number",modelValue:e(T),"onUpdate:modelValue":r[5]||(r[5]=n=>V(T)?T.value=n:null)},null,8,["modelValue"])]),a("div",ie,[t(e(L),{class:"w-[120px]"},{default:s(()=>[l("原因備註")]),_:1}),t(e(N),{class:"flex-1",type:"text",modelValue:e(U),"onUpdate:modelValue":r[6]||(r[6]=n=>V(U)?U.value=n:null)},null,8,["modelValue"])]),a("div",ce,[t(e(C),{class:"mr-2 flex-1",variant:"primary",onClick:r[7]||(r[7]=()=>e(d)(e(i),()=>u("close"))),disabled:!e(p)},{default:s(()=>[l(_(e(i)?"儲存":"申請"),1)]),_:1},8,["disabled"])])])]),_:1})]),_:1}))}});function me(f){const c=R(),{fetchUserLeaveList:b}=c,h=D(()=>c.userLeave),u=(m,v)=>{X().showModal({deleteType:"userLeave",title:G.global.t("delete-alert-title"),content:"確定要刪除這筆資料嗎？刪除後無法復原，需要重新新增",deleteData:{companyId:m,id:v}})};return b({companyId:f,page:1}),{userLeaveList:h,confirmDeleteUserLeave:u,fetchUserLeaveList:b}}const pe={class:"flex justify-between"},_e={class:"intro-y col-span-12 mt-2 flex flex-wrap items-center sm:flex-nowrap"},fe={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},be={class:"relative text-slate-500"},ve={class:"mt-5 grid grid-cols-12 gap-6"},xe={class:"intro-y col-span-12 flex flex-wrap items-center sm:flex-nowrap"},we={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},he={class:"relative text-slate-500"},ye={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},ke={class:"relative text-slate-500"},ge={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},Te={class:"relative text-slate-500"},Ce={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},Ue={class:"relative text-slate-500"},Ve={class:"intro-y col-span-12 overflow-auto lg:overflow-visible"},Le={class:"font-medium"},$e={class:"font-medium"},Ie={class:"font-medium"},De={class:"font-medium"},Se={class:"font-medium"},Me={class:"font-medium"},Ee={class:"font-medium"},Ye={class:"flex items-center justify-center"},Fe=q({__name:"UserLeavePage",setup(f){const c=M(1),{userLeaveList:b,confirmDeleteUserLeave:h}=me("1"),u=M(!1),m=M(-1),v=D(()=>b.value[m.value]||null),x=p=>{m.value=-1,p!==void 0&&(m.value=p),u.value=!0},k=()=>{console.log("onExportUserLeaveClick")},g=()=>{console.log("onImportButtonClick")},T=()=>{console.log("onDownloadImportExampleClick")},U=p=>{h(c.value,p)};return(p,i)=>(w(),$("div",null,[a("div",pe,[a("div",_e,[a("div",fe,[a("div",be,[t(e(N),{type:"text",class:"!box w-56 pr-10",placeholder:"Search..."}),t(e(y),{icon:"Search",class:"absolute inset-y-0 right-0 my-auto mr-3 h-4 w-4"})])])])]),a("div",ve,[a("div",xe,[a("div",we,[a("div",he,[t(e(C),{variant:"primary",type:"button",class:"m-3",onClick:i[0]||(i[0]=d=>x())},{default:s(()=>[t(e(y),{icon:"Plus",class:"mr-1 h-4 w-4"}),l(" 請假申請 ")]),_:1})])]),a("div",ye,[a("div",ke,[t(e(C),{variant:"primary",type:"button",class:"m-3",disabled:"",onClick:g},{default:s(()=>[t(e(y),{icon:"Upload",class:"mr-1 h-4 w-4"}),l(" 匯入請假 ")]),_:1})])]),a("div",ge,[a("div",Te,[t(e(C),{variant:"primary",type:"button",class:"m-3",disabled:"",onClick:k},{default:s(()=>[t(e(y),{icon:"Download",class:"mr-1 h-4 w-4"}),l(" 匯出請假 ")]),_:1})])]),a("div",Ce,[a("div",Ue,[t(e(C),{variant:"danger",type:"button",class:"m-3",disabled:"",onClick:T},{default:s(()=>[t(e(y),{icon:"Download",class:"mr-1 h-4 w-4"}),l(" 請假匯入範例 ")]),_:1})])])]),a("div",Ve,[t(e(o),{class:"-mt-2 border-separate border-spacing-y-[10px]"},{default:s(()=>[t(e(o).Thead,null,{default:s(()=>[t(e(o).Tr,null,{default:s(()=>[t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("員工編號")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("姓名")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l(" 假勤項目 ")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("開始時間")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("結束時間")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l(" 休息時間(小時) ")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l(" 原因備註 ")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("動作")]),_:1})]),_:1})]),_:1}),t(e(o).Tbody,null,{default:s(()=>[(w(!0),$(B,null,Y(e(b),(d,I)=>(w(),E(e(o).Tr,{key:I,class:"intro-x"},{default:s(()=>[t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",Le,_(d.employeeId),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",$e,_(d.userName),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",Ie,_(d.leaveName),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",De,_(e(z)(d.startTime).format("YYYY-MM-DD")),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",Se,_(e(z)(d.endTime).format("YYYY-MM-DD")),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",Me,_(d.restHours),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",Ee,_(d.description),1)]),_:2},1024),t(e(o).Td,{class:"relative w-56 border-b-0 bg-white py-0 shadow-[20px_3px_20px_#0000000b] before:absolute before:inset-y-0 before:left-0 before:my-auto before:block before:h-8 before:w-px before:bg-slate-200 first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600 before:dark:bg-darkmode-400"},{default:s(()=>[a("div",Ye,[t(e(C),{variant:"primary",type:"button",class:"m-3 w-20",onClick:r=>x(I)},{default:s(()=>[t(e(y),{icon:"Edit",class:"mr-1 h-4 w-4"}),l(" 修改 ")]),_:2},1032,["onClick"]),t(e(C),{variant:"danger",type:"button",class:"m-3 w-20",onClick:r=>U(d.id)},{default:s(()=>[t(e(y),{icon:"Trash",class:"mr-1 h-4 w-4"}),l(" 刪除 ")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),u.value?(w(),E(e(ue),{key:0,userLeave:v.value,onClose:i[1]||(i[1]=d=>u.value=!1),idx:m.value},null,8,["userLeave","idx"])):Q("",!0)]))}});export{Fe as default};

import{T as c}from"./index-aiEbVBin.js";import{u as M,r as B,t as N,b as R,d as U,e as S,P as O,i as D,g as j,o as g,j as V,k as s,s as t,m as o,n,p as $,q as e,_ as T,v as k,x as W,z as C,D as I,E as Y,G as F,h as L,w as P,c as E,y as z,F as q,A as G}from"./index-oBWQfhjf.js";import{_ as y,a as K}from"./FormSelect.vue_vue_type_script_setup_true_lang-WwyZrRan.js";import{_ as A}from"./FormDatepicker.vue_vue_type_script_setup_true_lang-SjeT_L7l.js";import"./_plugin-vue_export-helper-x3n3nnut.js";function X(p){const{companyId:d}=M(),l=B({userId:"",companyId:d.value??1,startTime:"",endTime:"",restHours:0,type:"HOLIDAY",description:""}),{userId:w,startTime:u,endTime:i,restHours:m,type:v,description:h}=N(l),b=R(()=>!!p);U(()=>{const _={};if(p){const a={...p,..._};Object.keys(l).forEach(r=>{a[r]!==void 0&&(l[r]=a[r])})}});const f=R(()=>{var _;return w.value!==""&&((_=d.value)==null?void 0:_.toString())!==""&&u.value!==""&&i.value!==""&&v.value!==""&&m.value.toString()!==""&&m.value>=0});return{userId:w,companyId:d,startTime:u,endTime:i,restHours:m,type:v,description:h,canSubmit:f,isEdit:b,submit:async(_,a)=>{const r=_?"update":"create";if(l.restHours<0){S().showError({title:"休息時間需大於0",content:"休息時間需大於0"});return}await{create:()=>D.post("/salary/work-record",{...l}),update:()=>D.patch(`/salary/work-record/${p.id}`,{...l,id:p.id})}[r](),S().showSaveSuccess(),a(),O().fetchWorkRecordList({companyId:d.value??1,page:1})}}}const J={class:"relative mb-5 text-center text-xl"},Q={class:"mb-4 flex items-center"},Z=o("option",{value:"HOLIDAY"},"例假日",-1),ee=o("option",{value:"OFFICIALHOLIDAY"},"國定假日",-1),te=o("option",{value:"RESTDAY"},"休息日",-1),se=o("option",{value:"WORKDAY"},"工作日",-1),oe={class:"mb-4 flex items-center"},ae={class:"mb-4 flex items-center"},le={class:"mb-4 flex items-center"},re={class:"mb-4 flex items-center"},de={class:"flex justify-center"},ne=j({__name:"CreateWorkRecordModal",props:{workRecord:{},idx:{}},emits:["close"],setup(p,{emit:d}){const l=d,{workRecord:w}=p,{startTime:u,endTime:i,type:m,restHours:v,description:h,canSubmit:b,isEdit:f,submit:x}=X(w);return(_,a)=>(g(),V(e(I),{open:!0,size:"md"},{default:s(()=>[t(e(I).Panel,{class:"p-4 md:w-[600px]"},{default:s(()=>[o("div",J,[n($(e(f)?"編輯加班/兼職":"加班/兼職申請")+" ",1),t(e(T),{icon:"X",class:"absolute right-0 top-0 cursor-pointer text-[#939393]",onClick:a[0]||(a[0]=()=>l("close"))})]),o("section",null,[o("div",Q,[t(e(y),{class:"w-[120px]"},{default:s(()=>[n("選擇加班歸屬日")]),_:1}),t(e(K),{class:"flex-1",modelValue:e(m),"onUpdate:modelValue":a[1]||(a[1]=r=>k(m)?m.value=r:null)},{default:s(()=>[Z,ee,te,se]),_:1},8,["modelValue"])]),o("div",oe,[t(e(y),{class:"w-[120px]"},{default:s(()=>[n("起始時間 *")]),_:1}),t(A,{class:"flex-1",modelValue:e(u),"onUpdate:modelValue":a[2]||(a[2]=r=>k(u)?u.value=r:null),detail:"","time-picker-inline":""},null,8,["modelValue"])]),o("div",ae,[t(e(y),{class:"w-[120px]"},{default:s(()=>[n("結束時間 *")]),_:1}),t(A,{class:"flex-1",modelValue:e(i),"onUpdate:modelValue":a[3]||(a[3]=r=>k(i)?i.value=r:null),detail:"","time-picker-inline":""},null,8,["modelValue"])]),o("div",le,[t(e(y),{class:"w-[120px]"},{default:s(()=>[n("休息時間 (小時) *")]),_:1}),t(e(W),{class:"flex-1",type:"number",min:"0",step:"0.1",modelValue:e(v),"onUpdate:modelValue":a[4]||(a[4]=r=>k(v)?v.value=r:null)},null,8,["modelValue"])]),o("div",re,[t(e(y),{class:"w-[120px]"},{default:s(()=>[n("工作內容備註")]),_:1}),t(e(W),{class:"flex-1",type:"text",modelValue:e(h),"onUpdate:modelValue":a[5]||(a[5]=r=>k(h)?h.value=r:null)},null,8,["modelValue"])]),o("div",de,[t(e(C),{class:"mr-2 flex-1",variant:"primary",onClick:a[6]||(a[6]=()=>e(x)(e(f),()=>l("close"))),disabled:!e(b)},{default:s(()=>[n($(e(f)?"儲存":"申請"),1)]),_:1},8,["disabled"])])])]),_:1})]),_:1}))}});function H(p){const d=O(),{fetchWorkRecordList:l}=d,w=R(()=>d.workRecordList),u=(i,m)=>{Y().showModal({deleteType:"workRecord",title:F.global.t("delete-alert-title"),content:"確定要刪除這筆資料嗎？刪除後無法復原，需要重新新增",deleteData:{companyId:i,id:m}})};return l({companyId:p,page:1}),{workRecordList:w,confirmDeleteWorkRecord:u,fetchWorkRecordList:l}}const ie={class:"flex justify-between"},ce={class:"intro-y col-span-12 mt-2 flex flex-wrap items-center sm:flex-nowrap"},ue={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},me={class:"relative text-slate-500"},pe={class:"mt-5 grid grid-cols-12 gap-6"},fe={class:"intro-y col-span-12 flex flex-wrap items-center sm:flex-nowrap"},_e={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},ve={class:"relative text-slate-500"},be={class:"intro-y col-span-12 overflow-auto lg:overflow-visible"},xe={class:"font-medium"},we={class:"font-medium"},he={class:"font-medium"},ke={class:"flex items-center justify-center"},Ve=j({__name:"WorkRecordListPage",setup(p){const{companyId:d}=M(),{workRecordList:l,confirmDeleteWorkRecord:w}=H(d.value??1),u=L(!1),i=L(-1);P(d,()=>{H(d.value??1)});const m=R(()=>l.value[i.value]||null),v=b=>{i.value=-1,b!==void 0&&(i.value=b),u.value=!0},h=b=>{w(d.value??1,b)};return(b,f)=>(g(),E("div",null,[o("div",ie,[o("div",ce,[o("div",ue,[o("div",me,[t(e(W),{type:"text",class:"!box w-56 pr-10",placeholder:"Search..."}),t(e(T),{icon:"Search",class:"absolute inset-y-0 right-0 my-auto mr-3 h-4 w-4"})])])])]),o("div",pe,[o("div",fe,[o("div",_e,[o("div",ve,[t(e(C),{variant:"primary",type:"button",class:"m-3",onClick:f[0]||(f[0]=x=>v())},{default:s(()=>[t(e(T),{icon:"Plus",class:"mr-1 h-4 w-4"}),n(" 新增手環匯率 ")]),_:1})])])]),o("div",be,[t(e(c),{class:"-mt-2 border-separate border-spacing-y-[10px]"},{default:s(()=>[t(e(c).Thead,null,{default:s(()=>[t(e(c).Tr,null,{default:s(()=>[t(e(c).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[n("比率")]),_:1}),t(e(c).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[n("有效期限")]),_:1}),t(e(c).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[n("建立時間")]),_:1}),t(e(c).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[n("動作")]),_:1})]),_:1})]),_:1}),t(e(c).Tbody,null,{default:s(()=>[(g(!0),E(q,null,G(e(l),(x,_)=>(g(),V(e(c).Tr,{key:_,class:"intro-x"},{default:s(()=>[t(e(c).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",xe,$(x.rate),1)]),_:2},1024),t(e(c).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",we,$(x.effective_date),1)]),_:2},1024),t(e(c).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",he,$(x.created_at),1)]),_:2},1024),t(e(c).Td,{class:"relative w-56 border-b-0 bg-white py-0 shadow-[20px_3px_20px_#0000000b] before:absolute before:inset-y-0 before:left-0 before:my-auto before:block before:h-8 before:w-px before:bg-slate-200 first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600 before:dark:bg-darkmode-400"},{default:s(()=>[o("div",ke,[t(e(C),{variant:"primary",type:"button",class:"m-3 w-20",onClick:a=>v(_)},{default:s(()=>[t(e(T),{icon:"Edit",class:"mr-1 h-4 w-4"}),n(" 修改 ")]),_:2},1032,["onClick"]),t(e(C),{variant:"danger",type:"button",class:"m-3 w-20",onClick:a=>h(x.id)},{default:s(()=>[t(e(T),{icon:"Trash",class:"mr-1 h-4 w-4"}),n(" 刪除 ")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),u.value?(g(),V(e(ne),{key:0,workRecord:m.value,onClose:f[1]||(f[1]=x=>u.value=!1),idx:i.value},null,8,["workRecord","idx"])):z("",!0)]))}});export{Ve as default};

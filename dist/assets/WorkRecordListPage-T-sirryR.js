import{n as F,p as P,c as I,q as z,s as K,N as H,x as L,d as N,o as C,i as S,w as s,g as t,e as o,f as a,t as w,h as e,_ as h,C as M,z as $,b as R,m as U,F as j,l as Y,k as T,D as E,K as q,L as J,r as W,j as X,J as A}from"./index-b9rVHk3c.js";import{T as l}from"./index-8u8Y7XR0.js";import{_ as V}from"./FormLabel.vue_vue_type_script_setup_true_lang-SlbvcGm7.js";import{_ as B}from"./FormDatepicker.vue_vue_type_script_setup_true_lang-A198NyF7.js";import{u as G}from"./useUser-_6MRtQx7.js";function Q(p){const c=F({userId:"",companyId:"1",startTime:"",endTime:"",restHours:0,type:"HOLIDAY",description:""}),{userId:_,companyId:x,startTime:f,endTime:i,restHours:b,type:v,description:k}=P(c),y=I(()=>!!p);z(()=>{const u={};if(p){const m={...p,...u};Object.keys(c).forEach(r=>{m[r]!==void 0&&(c[r]=m[r])})}});const g=I(()=>_.value!==""&&x.value!==""&&f.value!==""&&i.value!==""&&v.value!==""&&b.value.toString()!=="");return{userId:_,companyId:x,startTime:f,endTime:i,restHours:b,type:v,description:k,canSubmit:g,isEdit:y,submit:async(u,m)=>{const r=u?"update":"create";console.log(r),await{create:()=>L.post("/salary/work-record",{...c}),update:()=>L.patch(`/salary/work-record/${p.id}`,{...c,id:p.id})}[r](),K().showSaveSuccess(),m(),H().fetchWorkRecordList({companyId:"1",page:1})}}}const Z={class:"relative mb-5 text-center text-xl"},ee={class:"mb-4 flex items-center"},te=["value"],se={class:"mb-4 flex items-center"},oe=o("option",{value:"HOLIDAY"},"例假日",-1),ae=o("option",{value:"OFFICIALHOLIDAY"},"國定假日",-1),le=o("option",{value:"RESTDAY"},"休息日",-1),de=o("option",{value:"WORKDAY"},"工作日",-1),re={class:"mb-4 flex items-center"},ne={class:"mb-4 flex items-center"},ie={class:"mb-4 flex items-center"},ce={class:"mb-4 flex items-center"},ue={class:"flex justify-center"},me=N({__name:"CreateWorkRecordModal",props:{workRecord:{},idx:{}},emits:["close"],setup(p,{emit:c}){const{users:_}=G(),x=c,{workRecord:f}=p,{userId:i,startTime:b,endTime:v,type:k,restHours:y,description:g,canSubmit:D,isEdit:u,submit:m}=Q(f);return(r,d)=>(C(),S(e(E),{open:!0,size:"md"},{default:s(()=>[t(e(E).Panel,{class:"p-4 md:w-[600px]"},{default:s(()=>[o("div",Z,[a(w(e(u)?"加班/兼職申請"+(r.idx+1):"加班/兼職申請")+" ",1),t(e(h),{icon:"X",class:"absolute right-0 top-0 cursor-pointer text-[#939393]",onClick:d[0]||(d[0]=()=>x("close"))})]),o("section",null,[o("div",ee,[t(e(V),{class:"w-[120px]"},{default:s(()=>[a("選擇員工 *")]),_:1}),t(e(M),{class:"flex-1",type:"text",modelValue:e(i),"onUpdate:modelValue":d[1]||(d[1]=n=>$(i)?i.value=n:null)},{default:s(()=>[(C(!0),R(j,null,U(e(_),(n,O)=>(C(),R("option",{key:O,value:n.id},w(n.name),9,te))),128))]),_:1},8,["modelValue"])]),o("div",se,[t(e(V),{class:"w-[120px]"},{default:s(()=>[a("選擇加班歸屬日")]),_:1}),t(e(M),{class:"flex-1",modelValue:e(k),"onUpdate:modelValue":d[2]||(d[2]=n=>$(k)?k.value=n:null)},{default:s(()=>[oe,ae,le,de]),_:1},8,["modelValue"])]),o("div",re,[t(e(V),{class:"w-[120px]"},{default:s(()=>[a("起始時間 *")]),_:1}),t(B,{class:"flex-1",modelValue:e(b),"onUpdate:modelValue":d[3]||(d[3]=n=>$(b)?b.value=n:null),"auto-apply":"",detail:""},null,8,["modelValue"])]),o("div",ne,[t(e(V),{class:"w-[120px]"},{default:s(()=>[a("結束時間 *")]),_:1}),t(B,{class:"flex-1",modelValue:e(v),"onUpdate:modelValue":d[4]||(d[4]=n=>$(v)?v.value=n:null),"auto-apply":"",detail:""},null,8,["modelValue"])]),o("div",ie,[t(e(V),{class:"w-[120px]"},{default:s(()=>[a("休息時間 (小時) *")]),_:1}),t(e(Y),{class:"flex-1",type:"number",modelValue:e(y),"onUpdate:modelValue":d[5]||(d[5]=n=>$(y)?y.value=n:null)},null,8,["modelValue"])]),o("div",ce,[t(e(V),{class:"w-[120px]"},{default:s(()=>[a("工作內容備註")]),_:1}),t(e(Y),{class:"flex-1",type:"text",modelValue:e(g),"onUpdate:modelValue":d[6]||(d[6]=n=>$(g)?g.value=n:null)},null,8,["modelValue"])]),o("div",ue,[t(e(T),{class:"mr-2 flex-1",variant:"primary",onClick:d[7]||(d[7]=()=>e(m)(e(u),()=>x("close"))),disabled:!e(D)},{default:s(()=>[a(" 申請 ")]),_:1},8,["disabled"])])])]),_:1})]),_:1}))}});function pe(p){const c=H(),{fetchWorkRecordList:_}=c,x=I(()=>c.workRecordList),f=(i,b)=>{q().showModal({deleteType:"workRecord",title:J.global.t("delete-alert-title"),content:"確定要刪除這筆資料嗎？刪除後無法復原，需要重新新增",deleteData:{companyId:i,id:b}})};return _({companyId:p,page:1}),{workRecordList:x,confirmDeleteWorkRecord:f,fetchWorkRecordList:_}}const _e={class:"flex justify-between"},fe={class:"intro-y col-span-12 mt-2 flex flex-wrap items-center sm:flex-nowrap"},be={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},xe={class:"relative text-slate-500"},ve={class:"mt-5 grid grid-cols-12 gap-6"},we={class:"intro-y col-span-12 flex flex-wrap items-center sm:flex-nowrap"},he={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},ke={class:"relative text-slate-500"},ye={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},ge={class:"relative text-slate-500"},Te={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},Ce={class:"relative text-slate-500"},$e={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},Ve={class:"relative text-slate-500"},De={class:"intro-y col-span-12 overflow-auto lg:overflow-visible"},Ie={class:"font-medium"},Re={class:"font-medium"},We={class:"font-medium"},Se={class:"font-medium"},Ye={class:"font-medium"},Le={class:"font-medium"},Me={class:"font-medium"},Ee={class:"flex items-center justify-center"},je=N({__name:"WorkRecordListPage",setup(p){const c=W(1),{workRecordList:_,confirmDeleteWorkRecord:x}=pe("1"),f=W(!1),i=W(-1),b=I(()=>_.value[i.value]||null),v=u=>{i.value=-1,u!==void 0&&(i.value=u),f.value=!0},k=()=>{console.log("onExportWorkRecordClick")},y=()=>{console.log("onImportButtonClick")},g=()=>{console.log("onDownloadImportExampleClick")},D=u=>{x(c.value,u)};return(u,m)=>(C(),R("div",null,[o("div",_e,[o("div",fe,[o("div",be,[o("div",xe,[t(e(Y),{type:"text",class:"!box w-56 pr-10",placeholder:"Search..."}),t(e(h),{icon:"Search",class:"absolute inset-y-0 right-0 my-auto mr-3 h-4 w-4"})])])])]),o("div",ve,[o("div",we,[o("div",he,[o("div",ke,[t(e(T),{variant:"primary",type:"button",class:"m-3",onClick:m[0]||(m[0]=r=>v())},{default:s(()=>[t(e(h),{icon:"Plus",class:"mr-1 h-4 w-4"}),a(" 加班/兼職申請 ")]),_:1})])]),o("div",ye,[o("div",ge,[t(e(T),{variant:"primary",type:"button",class:"m-3",disabled:"",onClick:y},{default:s(()=>[t(e(h),{icon:"Upload",class:"mr-1 h-4 w-4"}),a(" 匯入加班/出勤 ")]),_:1})])]),o("div",Te,[o("div",Ce,[t(e(T),{variant:"primary",type:"button",class:"m-3",disabled:"",onClick:k},{default:s(()=>[t(e(h),{icon:"Download",class:"mr-1 h-4 w-4"}),a(" 匯出加班/出勤 ")]),_:1})])]),o("div",$e,[o("div",Ve,[t(e(T),{variant:"danger",type:"button",class:"m-3",disabled:"",onClick:g},{default:s(()=>[t(e(h),{icon:"Download",class:"mr-1 h-4 w-4"}),a(" 加班/兼職匯入範例 ")]),_:1})])])]),o("div",De,[t(e(l),{class:"-mt-2 border-separate border-spacing-y-[10px]"},{default:s(()=>[t(e(l).Thead,null,{default:s(()=>[t(e(l).Tr,null,{default:s(()=>[t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[a("員工編號")]),_:1}),t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[a("姓名")]),_:1}),t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[a(" 加班歸屬日 ")]),_:1}),t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[a("開始時間")]),_:1}),t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[a("結束時間")]),_:1}),t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[a(" 休息時間(小時) ")]),_:1}),t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[a(" 工作內容備註 ")]),_:1}),t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[a("動作")]),_:1})]),_:1})]),_:1}),t(e(l).Tbody,null,{default:s(()=>[(C(!0),R(j,null,U(e(_),(r,d)=>(C(),S(e(l).Tr,{key:d,class:"intro-x"},{default:s(()=>[t(e(l).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Ie,w(r.employeeId),1)]),_:2},1024),t(e(l).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Re,w(r.userName),1)]),_:2},1024),t(e(l).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",We,w(r.type),1)]),_:2},1024),t(e(l).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Se,w(e(A)(r.startTime).format("YYYY-MM-DD")),1)]),_:2},1024),t(e(l).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Ye,w(e(A)(r.endTime).format("YYYY-MM-DD")),1)]),_:2},1024),t(e(l).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Le,w(r.restHours),1)]),_:2},1024),t(e(l).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Me,w(r.description),1)]),_:2},1024),t(e(l).Td,{class:"relative w-56 border-b-0 bg-white py-0 shadow-[20px_3px_20px_#0000000b] before:absolute before:inset-y-0 before:left-0 before:my-auto before:block before:h-8 before:w-px before:bg-slate-200 first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600 before:dark:bg-darkmode-400"},{default:s(()=>[o("div",Ee,[t(e(T),{variant:"primary",type:"button",class:"m-3 w-20",onClick:n=>v(d)},{default:s(()=>[t(e(h),{icon:"Edit",class:"mr-1 h-4 w-4"}),a(" 修改 ")]),_:2},1032,["onClick"]),t(e(T),{variant:"danger",type:"button",class:"m-3 w-20",onClick:n=>D(r.id)},{default:s(()=>[t(e(h),{icon:"Trash",class:"mr-1 h-4 w-4"}),a(" 刪除 ")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),f.value?(C(),S(e(me),{key:0,workRecord:b.value,onClose:m[1]||(m[1]=r=>f.value=!1),idx:i.value},null,8,["workRecord","idx"])):X("",!0)]))}});export{je as default};

import{T as d}from"./index-aiEbVBin.js";import{I as q,i as I,u as D,r as G,t as O,b as S,d as X,e as J,g as H,o as T,j as M,k as s,s as t,m as a,n,p as y,q as e,_ as V,v as $,c as L,A as R,F as z,x as E,z as A,D as j,E as K,G as Q,h as B,w as W,y as Y}from"./index-oBWQfhjf.js";import{_ as C,a as Z}from"./FormSelect.vue_vue_type_script_setup_true_lang-WwyZrRan.js";import{_ as N}from"./FormDatepicker.vue_vue_type_script_setup_true_lang-SjeT_L7l.js";import{u as ee}from"./useLeave-1eEi6SK4.js";import"./_plugin-vue_export-helper-x3n3nnut.js";const F=q("advise",{state:()=>({advise:[]}),actions:{async fetchAdviseList({page:r,companyId:l}){I.get("/admin/ui/advise",{params:{page:r,companyId:l.toString()}}).then(o=>{this.advise=o.data.Result})},deleteAdvise(r,l){I.delete(`admin/ui/advise/${l}`,{params:{companyId:r}}).then(()=>{const{companyId:o}=D();this.fetchAdviseList({companyId:o.value??1,page:1})})}}});function te(r){const{companyId:l}=D(),o=G({userId:"1",companyId:l.value??1,startTime:"",endTime:"",restHours:0,leaveId:"",description:""}),{userId:h,startTime:m,endTime:p,restHours:f,leaveId:x,description:g}=O(o),_=S(()=>!!r);X(()=>{const c={};if(r){const w={...r,...c};Object.keys(o).forEach(k=>{w[k]!==void 0&&(o[k]=w[k])})}});const b=S(()=>{var c;return h.value!==""&&((c=l.value)==null?void 0:c.toString())!==""&&m.value!==""&&p.value!==""&&x.value!==""&&f.value.toString()!==""&&f.value>=0});return{userId:h,companyId:l,startTime:m,endTime:p,restHours:f,leaveId:x,description:g,canSubmit:b,isEdit:_,submit:async(c,w)=>{const k=c?"update":"create";console.log(k),await{create:()=>I.post("/admin/ui/advise",{...o}),update:()=>I.patch(`/admin/ui/advise/${r.id}`,{...o,id:r.id})}[k](),J().showSaveSuccess(),w(),F().fetchAdviseList({companyId:l.value??1,page:1})}}}const se={class:"relative mb-5 text-center text-xl"},ae={class:"mb-4 flex items-center"},le=["value"],oe={class:"mb-4 flex items-center"},de={class:"mb-4 flex items-center"},ne={class:"mb-4 flex items-center"},ie={class:"mb-4 flex items-center"},re={class:"flex justify-center"},ce=H({__name:"CreateAdviseModal",props:{userLeave:{},idx:{}},emits:["close"],setup(r,{emit:l}){const{companyId:o}=D(),{leaveList:h}=ee(o.value??1),m=l,{userLeave:p}=r,{startTime:f,endTime:x,leaveId:g,restHours:_,description:b,canSubmit:v,isEdit:c,submit:w}=te(p);return(k,i)=>(T(),M(e(j),{open:!0,size:"md"},{default:s(()=>[t(e(j).Panel,{class:"p-4 md:w-[600px]"},{default:s(()=>[a("div",se,[n(y(e(c)?"編輯請假申請":"請假申請")+" ",1),t(e(V),{icon:"X",class:"absolute right-0 top-0 cursor-pointer text-[#939393]",onClick:i[0]||(i[0]=()=>m("close"))})]),a("section",null,[a("div",ae,[t(e(C),{class:"w-[120px]"},{default:s(()=>[n("假別 *")]),_:1}),t(e(Z),{class:"flex-1",modelValue:e(g),"onUpdate:modelValue":i[1]||(i[1]=u=>$(g)?g.value=u:null)},{default:s(()=>[(T(!0),L(z,null,R(e(h),(u,P)=>(T(),L("option",{key:P,value:u.id},y(u.name),9,le))),128))]),_:1},8,["modelValue"])]),a("div",oe,[t(e(C),{class:"w-[120px]"},{default:s(()=>[n("起始時間 *")]),_:1}),t(N,{class:"flex-1",modelValue:e(f),"onUpdate:modelValue":i[2]||(i[2]=u=>$(f)?f.value=u:null),detail:"","time-picker-inline":""},null,8,["modelValue"])]),a("div",de,[t(e(C),{class:"w-[120px]"},{default:s(()=>[n("結束時間 *")]),_:1}),t(N,{class:"flex-1",modelValue:e(x),"onUpdate:modelValue":i[3]||(i[3]=u=>$(x)?x.value=u:null),detail:"","time-picker-inline":""},null,8,["modelValue"])]),a("div",ne,[t(e(C),{class:"w-[120px]"},{default:s(()=>[n("休息時間 (小時) *")]),_:1}),t(e(E),{class:"flex-1",type:"number",min:"0",modelValue:e(_),"onUpdate:modelValue":i[4]||(i[4]=u=>$(_)?_.value=u:null),step:"0.1"},null,8,["modelValue"])]),a("div",ie,[t(e(C),{class:"w-[120px]"},{default:s(()=>[n("原因備註")]),_:1}),t(e(E),{class:"flex-1",type:"text",modelValue:e(b),"onUpdate:modelValue":i[5]||(i[5]=u=>$(b)?b.value=u:null)},null,8,["modelValue"])]),a("div",re,[t(e(A),{class:"mr-2 flex-1",variant:"primary",onClick:i[6]||(i[6]=()=>e(w)(e(c),()=>m("close"))),disabled:!e(v)},{default:s(()=>[n(y(e(c)?"儲存":"申請"),1)]),_:1},8,["disabled"])])])]),_:1})]),_:1}))}});function U(r){const l=F(),{fetchAdviseList:o}=l,h=S(()=>l.advise),m=(p,f)=>{K().showModal({deleteType:"advise",title:Q.global.t("delete-alert-title"),content:"確定要刪除這筆資料嗎？刪除後無法復原，需要重新新增",deleteData:{companyId:p,id:f}})};return o({companyId:r,page:1}),{adviseList:h,confirmDeleteAdvise:m,fetchAdviseList:o}}const ue={class:"flex justify-between"},me={class:"intro-y col-span-12 mt-2 flex flex-wrap items-center sm:flex-nowrap"},pe={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},fe={class:"relative text-slate-500"},_e={class:"mt-5 grid grid-cols-12 gap-6"},ve={class:"intro-y col-span-12 flex flex-wrap items-center sm:flex-nowrap"},be={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},xe={class:"relative text-slate-500"},he={class:"intro-y col-span-12 overflow-auto lg:overflow-visible"},we={class:"font-medium"},ye={class:"font-medium"},ge={class:"font-medium"},ke={class:"font-medium"},Te={class:"font-medium"},$e={class:"flex items-center justify-center"},De=H({__name:"Advise",setup(r){const{companyId:l}=D(),{adviseList:o,confirmDeleteAdvise:h}=U(l.value??1),m=B(!1),p=B(-1);W(l,()=>{U(l.value??1)});const f=S(()=>o.value[p.value]||null),x=_=>{p.value=-1,_!==void 0&&(p.value=_),m.value=!0},g=_=>{h(l.value??1,_)};return(_,b)=>(T(),L("div",null,[a("div",ue,[a("div",me,[a("div",pe,[a("div",fe,[t(e(E),{type:"text",class:"!box w-56 pr-10",placeholder:"Search..."}),t(e(V),{icon:"Search",class:"absolute inset-y-0 right-0 my-auto mr-3 h-4 w-4"})])])])]),a("div",_e,[a("div",ve,[a("div",be,[a("div",xe,[t(e(A),{variant:"primary",type:"button",class:"m-3",onClick:b[0]||(b[0]=v=>x())},{default:s(()=>[t(e(V),{icon:"Plus",class:"mr-1 h-4 w-4"}),n(" 新增意見 ")]),_:1})])])]),a("div",he,[t(e(d),{class:"-mt-2 border-separate border-spacing-y-[10px]"},{default:s(()=>[t(e(d).Thead,null,{default:s(()=>[t(e(d).Tr,null,{default:s(()=>[t(e(d).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[n("會員")]),_:1}),t(e(d).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[n("標題")]),_:1}),t(e(d).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[n("內容")]),_:1}),t(e(d).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[n("回饋")]),_:1}),t(e(d).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[n("狀態")]),_:1}),t(e(d).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[n("動作")]),_:1})]),_:1})]),_:1}),t(e(d).Tbody,null,{default:s(()=>[(T(!0),L(z,null,R(e(o),(v,c)=>(T(),M(e(d).Tr,{key:c,class:"intro-x"},{default:s(()=>[t(e(d).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",we,y(v.members_id),1)]),_:2},1024),t(e(d).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",ye,y(v.title),1)]),_:2},1024),t(e(d).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",ge,y(v.content),1)]),_:2},1024),t(e(d).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",ke,y(v.response),1)]),_:2},1024),t(e(d).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",Te,y(v.advise_status),1)]),_:2},1024),t(e(d).Td,{class:"relative w-56 border-b-0 bg-white py-0 shadow-[20px_3px_20px_#0000000b] before:absolute before:inset-y-0 before:left-0 before:my-auto before:block before:h-8 before:w-px before:bg-slate-200 first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600 before:dark:bg-darkmode-400"},{default:s(()=>[a("div",$e,[t(e(A),{variant:"primary",type:"button",class:"m-3 w-20",onClick:w=>x(c)},{default:s(()=>[t(e(V),{icon:"Edit",class:"mr-1 h-4 w-4"}),n(" 修改 ")]),_:2},1032,["onClick"]),t(e(A),{variant:"danger",type:"button",class:"m-3 w-20",onClick:w=>g(v.id)},{default:s(()=>[t(e(V),{icon:"Trash",class:"mr-1 h-4 w-4"}),n(" 刪除 ")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),m.value?(T(),M(e(ce),{key:0,advise:f.value,onClose:b[1]||(b[1]=v=>m.value=!1),idx:p.value},null,8,["advise","idx"])):Y("",!0)]))}});export{De as default};

import{p as z,q as K,c as D,s as O,v as Q,Q as R,y as j,d as q,o as w,i as E,w as s,f as t,e as a,g as l,t as f,h as e,l as k,E as H,A as V,b as $,n as Y,F as B,m as N,_ as C,D as P,L as X,M as G,r as M,j as J,K as A}from"./index-gJgnG53e.js";import{T as o}from"./index-hO9Hz3qR.js";import{_ as L}from"./FormLabel.vue_vue_type_script_setup_true_lang-FtTE1i6h.js";import{_ as F}from"./FormDatepicker.vue_vue_type_script_setup_true_lang-6d158fgj.js";import{u as W}from"./useUser-1RWIge6k.js";import{u as Z}from"./useLeave-lBbYb_1h.js";function ee(b){const c=z({userId:"1",companyId:"1",startTime:"",endTime:"",restHours:0,leaveId:"",description:""}),{userId:v,companyId:h,startTime:u,endTime:m,restHours:p,leaveId:x,description:y}=K(c),g=D(()=>!!b);O(()=>{const _={};if(b){const i={...b,..._};Object.keys(c).forEach(d=>{i[d]!==void 0&&(c[d]=i[d])})}});const T=D(()=>v.value!==""&&h.value!==""&&u.value!==""&&m.value!==""&&x.value!==""&&p.value.toString()!==""&&p.value>=0);return{userId:v,companyId:h,startTime:u,endTime:m,restHours:p,leaveId:x,description:y,canSubmit:T,isEdit:g,submit:async(_,i)=>{const d=_?"update":"create";console.log(d),await{create:()=>j.post("/salary/user-leave",{...c}),update:()=>j.patch(`/salary/user-leave/${b.id}`,{...c,id:b.id})}[d](),Q().showSaveSuccess(),i(),R().fetchUserLeaveList({companyId:"1",page:1})}}}const te={class:"relative mb-5 text-center text-xl"},se={class:"mb-4 flex items-center"},ae=["value"],le={class:"mb-4 flex items-center"},oe=["value"],de={class:"mb-4 flex items-center"},re={class:"mb-4 flex items-center"},ne={class:"mb-4 flex items-center"},ie={class:"mb-4 flex items-center"},ce={class:"flex justify-center"},ue=q({__name:"CreateUserLeaveModal",props:{userLeave:{},idx:{}},emits:["close"],setup(b,{emit:c}){const{users:v}=W(),{leaveList:h}=Z("1"),u=c,{userLeave:m}=b,{userId:p,startTime:x,endTime:y,leaveId:g,restHours:T,description:U,canSubmit:_,isEdit:i,submit:d}=ee(m);return(I,r)=>(w(),E(e(P),{open:!0,size:"md"},{default:s(()=>[t(e(P).Panel,{class:"p-4 md:w-[600px]"},{default:s(()=>[a("div",te,[l(f((e(i),"請假申請"))+" ",1),t(e(k),{icon:"X",class:"absolute right-0 top-0 cursor-pointer text-[#939393]",onClick:r[0]||(r[0]=()=>u("close"))})]),a("section",null,[a("div",se,[t(e(L),{class:"w-[120px]"},{default:s(()=>[l("選擇員工 *")]),_:1}),t(e(H),{class:"flex-1",type:"text",modelValue:e(p),"onUpdate:modelValue":r[1]||(r[1]=n=>V(p)?p.value=n:null)},{default:s(()=>[(w(!0),$(B,null,Y(e(v),(n,S)=>(w(),$("option",{key:S,value:n.id},f(n.name),9,ae))),128))]),_:1},8,["modelValue"])]),a("div",le,[t(e(L),{class:"w-[120px]"},{default:s(()=>[l("假別 *")]),_:1}),t(e(H),{class:"flex-1",modelValue:e(g),"onUpdate:modelValue":r[2]||(r[2]=n=>V(g)?g.value=n:null)},{default:s(()=>[(w(!0),$(B,null,Y(e(h),(n,S)=>(w(),$("option",{key:S,value:n.id},f(n.name),9,oe))),128))]),_:1},8,["modelValue"])]),a("div",de,[t(e(L),{class:"w-[120px]"},{default:s(()=>[l("起始時間 *")]),_:1}),t(F,{class:"flex-1",modelValue:e(x),"onUpdate:modelValue":r[3]||(r[3]=n=>V(x)?x.value=n:null),detail:"","time-picker-inline":""},null,8,["modelValue"])]),a("div",re,[t(e(L),{class:"w-[120px]"},{default:s(()=>[l("結束時間 *")]),_:1}),t(F,{class:"flex-1",modelValue:e(y),"onUpdate:modelValue":r[4]||(r[4]=n=>V(y)?y.value=n:null),detail:"","time-picker-inline":""},null,8,["modelValue"])]),a("div",ne,[t(e(L),{class:"w-[120px]"},{default:s(()=>[l("休息時間 (小時) *")]),_:1}),t(e(N),{class:"flex-1",type:"number",modelValue:e(T),"onUpdate:modelValue":r[5]||(r[5]=n=>V(T)?T.value=n:null)},null,8,["modelValue"])]),a("div",ie,[t(e(L),{class:"w-[120px]"},{default:s(()=>[l("原因備註")]),_:1}),t(e(N),{class:"flex-1",type:"text",modelValue:e(U),"onUpdate:modelValue":r[6]||(r[6]=n=>V(U)?U.value=n:null)},null,8,["modelValue"])]),a("div",ce,[t(e(C),{class:"mr-2 flex-1",variant:"primary",onClick:r[7]||(r[7]=()=>e(d)(e(i),()=>u("close"))),disabled:!e(_)},{default:s(()=>[l(f(e(i)?"儲存":"申請"),1)]),_:1},8,["disabled"])])])]),_:1})]),_:1}))}});function me(b){const c=R(),{fetchUserLeaveList:v}=c,h=D(()=>c.userLeave),u=(m,p)=>{X().showModal({deleteType:"userLeave",title:G.global.t("delete-alert-title"),content:"確定要刪除這筆資料嗎？刪除後無法復原，需要重新新增",deleteData:{companyId:m,id:p}})};return v({companyId:b,page:1}),{userLeaveList:h,confirmDeleteUserLeave:u,fetchUserLeaveList:v}}const pe={class:"flex justify-between"},_e={class:"intro-y col-span-12 mt-2 flex flex-wrap items-center sm:flex-nowrap"},fe={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},be={class:"relative text-slate-500"},ve={class:"mt-5 grid grid-cols-12 gap-6"},xe={class:"intro-y col-span-12 flex flex-wrap items-center sm:flex-nowrap"},we={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},he={class:"relative text-slate-500"},ke={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},ye={class:"relative text-slate-500"},ge={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},Te={class:"relative text-slate-500"},Ce={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},Ue={class:"relative text-slate-500"},Ve={class:"intro-y col-span-12 overflow-auto lg:overflow-visible"},Le={class:"font-medium"},$e={class:"font-medium"},Ie={class:"font-medium"},De={class:"font-medium"},Se={class:"font-medium"},Me={class:"font-medium"},Ee={class:"font-medium"},Ye={class:"flex items-center justify-center"},Fe=q({__name:"UserLeavePage",setup(b){const c=M(1),{userLeaveList:v,confirmDeleteUserLeave:h}=me("1"),u=M(!1),m=M(-1),p=D(()=>v.value[m.value]||null),x=_=>{m.value=-1,_!==void 0&&(m.value=_),u.value=!0},y=()=>{console.log("onExportUserLeaveClick")},g=()=>{console.log("onImportButtonClick")},T=()=>{console.log("onDownloadImportExampleClick")},U=_=>{h(c.value,_)};return(_,i)=>(w(),$("div",null,[a("div",pe,[a("div",_e,[a("div",fe,[a("div",be,[t(e(N),{type:"text",class:"!box w-56 pr-10",placeholder:"Search..."}),t(e(k),{icon:"Search",class:"absolute inset-y-0 right-0 my-auto mr-3 h-4 w-4"})])])])]),a("div",ve,[a("div",xe,[a("div",we,[a("div",he,[t(e(C),{variant:"primary",type:"button",class:"m-3",onClick:i[0]||(i[0]=d=>x())},{default:s(()=>[t(e(k),{icon:"Plus",class:"mr-1 h-4 w-4"}),l(" 請假申請 ")]),_:1})])]),a("div",ke,[a("div",ye,[t(e(C),{variant:"primary",type:"button",class:"m-3",disabled:"",onClick:g},{default:s(()=>[t(e(k),{icon:"Upload",class:"mr-1 h-4 w-4"}),l(" 匯入請假 ")]),_:1})])]),a("div",ge,[a("div",Te,[t(e(C),{variant:"primary",type:"button",class:"m-3",disabled:"",onClick:y},{default:s(()=>[t(e(k),{icon:"Download",class:"mr-1 h-4 w-4"}),l(" 匯出請假 ")]),_:1})])]),a("div",Ce,[a("div",Ue,[t(e(C),{variant:"danger",type:"button",class:"m-3",disabled:"",onClick:T},{default:s(()=>[t(e(k),{icon:"Download",class:"mr-1 h-4 w-4"}),l(" 請假匯入範例 ")]),_:1})])])]),a("div",Ve,[t(e(o),{class:"-mt-2 border-separate border-spacing-y-[10px]"},{default:s(()=>[t(e(o).Thead,null,{default:s(()=>[t(e(o).Tr,null,{default:s(()=>[t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("員工編號")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("姓名")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l(" 假勤項目 ")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("開始時間")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("結束時間")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l(" 休息時間(小時) ")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l(" 原因備註 ")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("動作")]),_:1})]),_:1})]),_:1}),t(e(o).Tbody,null,{default:s(()=>[(w(!0),$(B,null,Y(e(v),(d,I)=>(w(),E(e(o).Tr,{key:I,class:"intro-x"},{default:s(()=>[t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",Le,f(d.employeeId),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",$e,f(d.userName),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",Ie,f(d.leaveName),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",De,f(e(A)(d.startTime).format("YYYY-MM-DD")),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",Se,f(e(A)(d.endTime).format("YYYY-MM-DD")),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",Me,f(d.restHours),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",Ee,f(d.description),1)]),_:2},1024),t(e(o).Td,{class:"relative w-56 border-b-0 bg-white py-0 shadow-[20px_3px_20px_#0000000b] before:absolute before:inset-y-0 before:left-0 before:my-auto before:block before:h-8 before:w-px before:bg-slate-200 first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600 before:dark:bg-darkmode-400"},{default:s(()=>[a("div",Ye,[t(e(C),{variant:"primary",type:"button",class:"m-3 w-20",onClick:r=>x(I)},{default:s(()=>[t(e(k),{icon:"Edit",class:"mr-1 h-4 w-4"}),l(" 修改 ")]),_:2},1032,["onClick"]),t(e(C),{variant:"danger",type:"button",class:"m-3 w-20",onClick:r=>U(d.id)},{default:s(()=>[t(e(k),{icon:"Trash",class:"mr-1 h-4 w-4"}),l(" 刪除 ")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),u.value?(w(),E(e(ue),{key:0,userLeave:p.value,onClose:i[1]||(i[1]=d=>u.value=!1),idx:m.value},null,8,["userLeave","idx"])):J("",!0)]))}});export{Fe as default};

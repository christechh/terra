import{T as a}from"./index-l3_pW_kP.js";import{u as A,p as q,q as Q,c as W,s as X,v as E,Q as j,y as H,d as F,o as $,i as S,w as s,g as t,e as o,f as l,t as b,h as e,_ as w,C as O,z as V,b as R,n as P,F as z,m as L,l as C,D as Y,M as G,N as J,r as M,H as Z,j as ee,L as B}from"./index-BNNQ-ZD2.js";import{_ as D}from"./FormLabel.vue_vue_type_script_setup_true_lang-Emo7CXcT.js";import{_ as N}from"./FormDatepicker.vue_vue_type_script_setup_true_lang-wX7Xinbi.js";import{u as te}from"./useUser-hpnwHm0p.js";function se(v){const{companyId:c}=A(),u=q({userId:"",companyId:c.value,startTime:"",endTime:"",restHours:0,type:"HOLIDAY",description:""}),{userId:h,startTime:p,endTime:_,restHours:f,type:x,description:k}=Q(u),y=W(()=>!!v);X(()=>{const T={};if(v){const r={...v,...T};Object.keys(u).forEach(m=>{r[m]!==void 0&&(u[m]=r[m])})}});const g=W(()=>h.value!==""&&c.value.toString()!==""&&p.value!==""&&_.value!==""&&x.value!==""&&f.value.toString()!==""&&f.value>=0);return{userId:h,companyId:c,startTime:p,endTime:_,restHours:f,type:x,description:k,canSubmit:g,isEdit:y,submit:async(T,r)=>{const m=T?"update":"create";if(u.restHours<0){E().showError({title:"休息時間需大於0",content:"休息時間需大於0"});return}await{create:()=>H.post("/salary/work-record",{...u}),update:()=>H.patch(`/salary/work-record/${v.id}`,{...u,id:v.id})}[m](),E().showSaveSuccess(),r(),j().fetchWorkRecordList({companyId:c.value,page:1})}}}const oe={class:"relative mb-5 text-center text-xl"},ae={class:"mb-4 flex items-center"},le=["value"],de={class:"mb-4 flex items-center"},re=o("option",{value:"HOLIDAY"},"例假日",-1),ne=o("option",{value:"OFFICIALHOLIDAY"},"國定假日",-1),ie=o("option",{value:"RESTDAY"},"休息日",-1),ce=o("option",{value:"WORKDAY"},"工作日",-1),ue={class:"mb-4 flex items-center"},me={class:"mb-4 flex items-center"},pe={class:"mb-4 flex items-center"},_e={class:"mb-4 flex items-center"},fe={class:"flex justify-center"},be=F({__name:"CreateWorkRecordModal",props:{workRecord:{},idx:{}},emits:["close"],setup(v,{emit:c}){const{companyId:u}=A(),{users:h}=te(u.value),p=c,{workRecord:_}=v,{userId:f,startTime:x,endTime:k,type:y,restHours:g,description:I,canSubmit:T,isEdit:r,submit:m}=se(_);return(i,d)=>($(),S(e(Y),{open:!0,size:"md"},{default:s(()=>[t(e(Y).Panel,{class:"p-4 md:w-[600px]"},{default:s(()=>[o("div",oe,[l(b(e(r)?"編輯加班/兼職":"加班/兼職申請")+" ",1),t(e(w),{icon:"X",class:"absolute right-0 top-0 cursor-pointer text-[#939393]",onClick:d[0]||(d[0]=()=>p("close"))})]),o("section",null,[o("div",ae,[t(e(D),{class:"w-[120px]"},{default:s(()=>[l("選擇員工 *")]),_:1}),t(e(O),{class:"flex-1",type:"text",modelValue:e(f),"onUpdate:modelValue":d[1]||(d[1]=n=>V(f)?f.value=n:null)},{default:s(()=>[($(!0),R(z,null,P(e(h),(n,K)=>($(),R("option",{key:K,value:n.id},b(n.name),9,le))),128))]),_:1},8,["modelValue"])]),o("div",de,[t(e(D),{class:"w-[120px]"},{default:s(()=>[l("選擇加班歸屬日")]),_:1}),t(e(O),{class:"flex-1",modelValue:e(y),"onUpdate:modelValue":d[2]||(d[2]=n=>V(y)?y.value=n:null)},{default:s(()=>[re,ne,ie,ce]),_:1},8,["modelValue"])]),o("div",ue,[t(e(D),{class:"w-[120px]"},{default:s(()=>[l("起始時間 *")]),_:1}),t(N,{class:"flex-1",modelValue:e(x),"onUpdate:modelValue":d[3]||(d[3]=n=>V(x)?x.value=n:null),detail:"","time-picker-inline":""},null,8,["modelValue"])]),o("div",me,[t(e(D),{class:"w-[120px]"},{default:s(()=>[l("結束時間 *")]),_:1}),t(N,{class:"flex-1",modelValue:e(k),"onUpdate:modelValue":d[4]||(d[4]=n=>V(k)?k.value=n:null),detail:"","time-picker-inline":""},null,8,["modelValue"])]),o("div",pe,[t(e(D),{class:"w-[120px]"},{default:s(()=>[l("休息時間 (小時) *")]),_:1}),t(e(L),{class:"flex-1",type:"number",min:"0",modelValue:e(g),"onUpdate:modelValue":d[5]||(d[5]=n=>V(g)?g.value=n:null)},null,8,["modelValue"])]),o("div",_e,[t(e(D),{class:"w-[120px]"},{default:s(()=>[l("工作內容備註")]),_:1}),t(e(L),{class:"flex-1",type:"text",modelValue:e(I),"onUpdate:modelValue":d[6]||(d[6]=n=>V(I)?I.value=n:null)},null,8,["modelValue"])]),o("div",fe,[t(e(C),{class:"mr-2 flex-1",variant:"primary",onClick:d[7]||(d[7]=()=>e(m)(e(r),()=>p("close"))),disabled:!e(T)},{default:s(()=>[l(b(e(r)?"儲存":"申請"),1)]),_:1},8,["disabled"])])])]),_:1})]),_:1}))}});function U(v){const c=j(),{fetchWorkRecordList:u}=c,h=W(()=>c.workRecordList),p=(_,f)=>{G().showModal({deleteType:"workRecord",title:J.global.t("delete-alert-title"),content:"確定要刪除這筆資料嗎？刪除後無法復原，需要重新新增",deleteData:{companyId:_,id:f}})};return u({companyId:v,page:1}),{workRecordList:h,confirmDeleteWorkRecord:p,fetchWorkRecordList:u}}const ve={class:"flex justify-between"},xe={class:"intro-y col-span-12 mt-2 flex flex-wrap items-center sm:flex-nowrap"},he={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},we={class:"relative text-slate-500"},ke={class:"mt-5 grid grid-cols-12 gap-6"},ye={class:"intro-y col-span-12 flex flex-wrap items-center sm:flex-nowrap"},ge={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},Te={class:"relative text-slate-500"},Ce={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},$e={class:"relative text-slate-500"},Ie={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},Ve={class:"relative text-slate-500"},De={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},We={class:"relative text-slate-500"},Re={class:"intro-y col-span-12 overflow-auto lg:overflow-visible"},Se={class:"font-medium"},Le={class:"font-medium"},Ae={class:"font-medium"},Ee={class:"font-medium"},He={class:"font-medium"},Oe={class:"font-medium"},Ye={class:"font-medium"},Me={class:"font-medium"},Be={class:"flex items-center justify-center"},ze=F({__name:"WorkRecordListPage",setup(v){const{companyId:c}=A(),{workRecordList:u,confirmDeleteWorkRecord:h}=U(c.value),p=M(!1),_=M(-1);Z(c,()=>{U(c.value)});const f=W(()=>u.value[_.value]||null),x=r=>{_.value=-1,r!==void 0&&(_.value=r),p.value=!0},k=()=>{console.log("onExportWorkRecordClick")},y=()=>{console.log("onImportButtonClick")},g=()=>{console.log("onDownloadImportExampleClick")},I=r=>{h(c.value,r)},T=r=>({HOLIDAY:"例假日",OFFICIALHOLIDAY:"國定假日",RESTDAY:"休息日",WORKDAY:"工作日"})[r]||"null";return(r,m)=>($(),R("div",null,[o("div",ve,[o("div",xe,[o("div",he,[o("div",we,[t(e(L),{type:"text",class:"!box w-56 pr-10",placeholder:"Search..."}),t(e(w),{icon:"Search",class:"absolute inset-y-0 right-0 my-auto mr-3 h-4 w-4"})])])])]),o("div",ke,[o("div",ye,[o("div",ge,[o("div",Te,[t(e(C),{variant:"primary",type:"button",class:"m-3",onClick:m[0]||(m[0]=i=>x())},{default:s(()=>[t(e(w),{icon:"Plus",class:"mr-1 h-4 w-4"}),l(" 加班/兼職申請 ")]),_:1})])]),o("div",Ce,[o("div",$e,[t(e(C),{variant:"primary",type:"button",class:"m-3",disabled:"",onClick:y},{default:s(()=>[t(e(w),{icon:"Upload",class:"mr-1 h-4 w-4"}),l(" 匯入加班/出勤 ")]),_:1})])]),o("div",Ie,[o("div",Ve,[t(e(C),{variant:"primary",type:"button",class:"m-3",disabled:"",onClick:k},{default:s(()=>[t(e(w),{icon:"Download",class:"mr-1 h-4 w-4"}),l(" 匯出加班/出勤 ")]),_:1})])]),o("div",De,[o("div",We,[t(e(C),{variant:"danger",type:"button",class:"m-3",disabled:"",onClick:g},{default:s(()=>[t(e(w),{icon:"Download",class:"mr-1 h-4 w-4"}),l(" 加班/兼職匯入範例 ")]),_:1})])])]),o("div",Re,[t(e(a),{class:"-mt-2 border-separate border-spacing-y-[10px]"},{default:s(()=>[t(e(a).Thead,null,{default:s(()=>[t(e(a).Tr,null,{default:s(()=>[t(e(a).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("員工編號")]),_:1}),t(e(a).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("姓名")]),_:1}),t(e(a).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l(" 加班歸屬日 ")]),_:1}),t(e(a).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("開始時間")]),_:1}),t(e(a).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("結束時間")]),_:1}),t(e(a).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l(" 休息時間(小時) ")]),_:1}),t(e(a).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l(" 時數（小時） ")]),_:1}),t(e(a).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l(" 工作內容備註 ")]),_:1}),t(e(a).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("動作")]),_:1})]),_:1})]),_:1}),t(e(a).Tbody,null,{default:s(()=>[($(!0),R(z,null,P(e(u),(i,d)=>($(),S(e(a).Tr,{key:d,class:"intro-x"},{default:s(()=>[t(e(a).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Se,b(i.employeeId),1)]),_:2},1024),t(e(a).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Le,b(i.userName),1)]),_:2},1024),t(e(a).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Ae,b(T(i.type)),1)]),_:2},1024),t(e(a).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Ee,b(i.startTime),1)]),_:2},1024),t(e(a).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",He,b(i.endTime),1)]),_:2},1024),t(e(a).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Oe,b(i.restHours),1)]),_:2},1024),t(e(a).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Ye,b(e(B)(i.endTime).diff(e(B)(i.startTime),"hour")-i.restHours),1)]),_:2},1024),t(e(a).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Me,b(i.description),1)]),_:2},1024),t(e(a).Td,{class:"relative w-56 border-b-0 bg-white py-0 shadow-[20px_3px_20px_#0000000b] before:absolute before:inset-y-0 before:left-0 before:my-auto before:block before:h-8 before:w-px before:bg-slate-200 first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600 before:dark:bg-darkmode-400"},{default:s(()=>[o("div",Be,[t(e(C),{variant:"primary",type:"button",class:"m-3 w-20",onClick:n=>x(d)},{default:s(()=>[t(e(w),{icon:"Edit",class:"mr-1 h-4 w-4"}),l(" 修改 ")]),_:2},1032,["onClick"]),t(e(C),{variant:"danger",type:"button",class:"m-3 w-20",onClick:n=>I(i.id)},{default:s(()=>[t(e(w),{icon:"Trash",class:"mr-1 h-4 w-4"}),l(" 刪除 ")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),p.value?($(),S(e(be),{key:0,workRecord:f.value,onClose:m[1]||(m[1]=i=>p.value=!1),idx:_.value},null,8,["workRecord","idx"])):ee("",!0)]))}});export{ze as default};

import{T as o}from"./index-7Gt0fBvr.js";import{u as j,p as J,q as K,c as S,s as Q,v as W,U as X,y as P,d as A,o as w,i as E,w as s,g as t,e as a,f as d,t as p,h as e,_ as k,G as F,z as V,b as I,n as N,F as B,m as M,l as C,D as z,O as Y,P as Z,r as O,C as ee,j as te,N as R}from"./index-Ike7Oe7a.js";import{_ as $}from"./FormLabel.vue_vue_type_script_setup_true_lang-DWAbhv1F.js";import{_ as q}from"./FormDatepicker.vue_vue_type_script_setup_true_lang-jpijDMMK.js";import{u as se}from"./useUser-dtGdUi1a.js";import{u as ae}from"./useLeave-GKl8XYk8.js";function le(f){const{companyId:c}=j(),u=J({userId:"1",companyId:c.value??1,startTime:"",endTime:"",restHours:0,leaveId:"",description:""}),{userId:h,startTime:b,endTime:m,restHours:v,leaveId:x,description:y}=K(u),g=S(()=>!!f);Q(()=>{const n={};if(f){const _={...f,...n};Object.keys(u).forEach(l=>{_[l]!==void 0&&(u[l]=_[l])})}});const T=S(()=>{var n;return h.value!==""&&((n=c.value)==null?void 0:n.toString())!==""&&b.value!==""&&m.value!==""&&x.value!==""&&v.value.toString()!==""&&v.value>=0});return{userId:h,companyId:c,startTime:b,endTime:m,restHours:v,leaveId:x,description:y,canSubmit:T,isEdit:g,submit:async(n,_)=>{const l=n?"update":"create";console.log(l),await{create:()=>P.post("/salary/user-leave",{...u}),update:()=>P.patch(`/salary/user-leave/${f.id}`,{...u,id:f.id})}[l](),W().showSaveSuccess(),_(),X().fetchUserLeaveList({companyId:c.value??1,page:1})}}}const oe={class:"relative mb-5 text-center text-xl"},de={class:"mb-4 flex items-center"},re=["value"],ne={class:"mb-4 flex items-center"},ie=["value"],ce={class:"mb-4 flex items-center"},ue={class:"mb-4 flex items-center"},me={class:"mb-4 flex items-center"},pe={class:"mb-4 flex items-center"},_e={class:"flex justify-center"},fe=A({__name:"CreateUserLeaveModal",props:{userLeave:{},idx:{}},emits:["close"],setup(f,{emit:c}){const{companyId:u}=j(),{users:h}=se(u.value??1),{leaveList:b}=ae(u.value??1),m=c,{userLeave:v}=f,{userId:x,startTime:y,endTime:g,leaveId:T,restHours:U,description:n,canSubmit:_,isEdit:l,submit:L}=le(v);return(H,i)=>(w(),E(e(z),{open:!0,size:"md"},{default:s(()=>[t(e(z).Panel,{class:"p-4 md:w-[600px]"},{default:s(()=>[a("div",oe,[d(p(e(l)?"編輯請假申請":"請假申請")+" ",1),t(e(k),{icon:"X",class:"absolute right-0 top-0 cursor-pointer text-[#939393]",onClick:i[0]||(i[0]=()=>m("close"))})]),a("section",null,[a("div",de,[t(e($),{class:"w-[120px]"},{default:s(()=>[d("選擇員工 *")]),_:1}),t(e(F),{class:"flex-1",type:"text",modelValue:e(x),"onUpdate:modelValue":i[1]||(i[1]=r=>V(x)?x.value=r:null)},{default:s(()=>[(w(!0),I(B,null,N(e(h),(r,D)=>(w(),I("option",{key:D,value:r.id},p(r.name),9,re))),128))]),_:1},8,["modelValue"])]),a("div",ne,[t(e($),{class:"w-[120px]"},{default:s(()=>[d("假別 *")]),_:1}),t(e(F),{class:"flex-1",modelValue:e(T),"onUpdate:modelValue":i[2]||(i[2]=r=>V(T)?T.value=r:null)},{default:s(()=>[(w(!0),I(B,null,N(e(b),(r,D)=>(w(),I("option",{key:D,value:r.id},p(r.name),9,ie))),128))]),_:1},8,["modelValue"])]),a("div",ce,[t(e($),{class:"w-[120px]"},{default:s(()=>[d("起始時間 *")]),_:1}),t(q,{class:"flex-1",modelValue:e(y),"onUpdate:modelValue":i[3]||(i[3]=r=>V(y)?y.value=r:null),detail:"","time-picker-inline":""},null,8,["modelValue"])]),a("div",ue,[t(e($),{class:"w-[120px]"},{default:s(()=>[d("結束時間 *")]),_:1}),t(q,{class:"flex-1",modelValue:e(g),"onUpdate:modelValue":i[4]||(i[4]=r=>V(g)?g.value=r:null),detail:"","time-picker-inline":""},null,8,["modelValue"])]),a("div",me,[t(e($),{class:"w-[120px]"},{default:s(()=>[d("休息時間 (小時) *")]),_:1}),t(e(M),{class:"flex-1",type:"number",min:"0",modelValue:e(U),"onUpdate:modelValue":i[5]||(i[5]=r=>V(U)?U.value=r:null),step:"0.1"},null,8,["modelValue"])]),a("div",pe,[t(e($),{class:"w-[120px]"},{default:s(()=>[d("原因備註")]),_:1}),t(e(M),{class:"flex-1",type:"text",modelValue:e(n),"onUpdate:modelValue":i[6]||(i[6]=r=>V(n)?n.value=r:null)},null,8,["modelValue"])]),a("div",_e,[t(e(C),{class:"mr-2 flex-1",variant:"primary",onClick:i[7]||(i[7]=()=>e(L)(e(l),()=>m("close"))),disabled:!e(_)},{default:s(()=>[d(p(e(l)?"儲存":"申請"),1)]),_:1},8,["disabled"])])])]),_:1})]),_:1}))}});function G(f){const c=X(),{fetchUserLeaveList:u}=c,h=S(()=>c.userLeave),b=(m,v)=>{Y().showModal({deleteType:"userLeave",title:Z.global.t("delete-alert-title"),content:"確定要刪除這筆資料嗎？刪除後無法復原，需要重新新增",deleteData:{companyId:m,id:v}})};return u({companyId:f,page:1}),{userLeaveList:h,confirmDeleteUserLeave:b,fetchUserLeaveList:u}}const be={class:"flex justify-between"},ve={class:"intro-y col-span-12 mt-2 flex flex-wrap items-center sm:flex-nowrap"},xe={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},we={class:"relative text-slate-500"},he={class:"mt-5 grid grid-cols-12 gap-6"},ke={class:"intro-y col-span-12 flex flex-wrap items-center sm:flex-nowrap"},ye={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},ge={class:"relative text-slate-500"},Te={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},Ce={class:"relative text-slate-500"},Ue={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},Ve={class:"relative text-slate-500"},$e={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},Ie={class:"relative text-slate-500"},Le={class:"intro-y col-span-12 overflow-auto lg:overflow-visible"},Se={class:"font-medium"},De={class:"font-medium"},Ee={class:"font-medium"},Ne={class:"font-medium"},Be={class:"font-medium"},Me={class:"font-medium"},je={class:"font-medium"},He={class:"font-medium"},Pe={class:"flex items-center justify-center"},Xe=A({__name:"UserLeavePage",setup(f){const{companyId:c}=j(),{userLeaveList:u,confirmDeleteUserLeave:h}=G(c.value??1),b=O(!1),m=O(-1);ee(c,()=>{G(c.value??1)});const v=S(()=>u.value[m.value]||null),x=n=>{m.value=-1,n!==void 0&&(m.value=n),b.value=!0},y=()=>{console.log("onExportUserLeaveClick")},g=()=>{console.log("onImportButtonClick")},T=()=>{console.log("onDownloadImportExampleClick")},U=n=>{h(c.value??1,n)};return(n,_)=>(w(),I("div",null,[a("div",be,[a("div",ve,[a("div",xe,[a("div",we,[t(e(M),{type:"text",class:"!box w-56 pr-10",placeholder:"Search..."}),t(e(k),{icon:"Search",class:"absolute inset-y-0 right-0 my-auto mr-3 h-4 w-4"})])])])]),a("div",he,[a("div",ke,[a("div",ye,[a("div",ge,[t(e(C),{variant:"primary",type:"button",class:"m-3",onClick:_[0]||(_[0]=l=>x())},{default:s(()=>[t(e(k),{icon:"Plus",class:"mr-1 h-4 w-4"}),d(" 請假申請 ")]),_:1})])]),a("div",Te,[a("div",Ce,[t(e(C),{variant:"primary",type:"button",class:"m-3",disabled:"",onClick:g},{default:s(()=>[t(e(k),{icon:"Upload",class:"mr-1 h-4 w-4"}),d(" 匯入請假 ")]),_:1})])]),a("div",Ue,[a("div",Ve,[t(e(C),{variant:"primary",type:"button",class:"m-3",disabled:"",onClick:y},{default:s(()=>[t(e(k),{icon:"Download",class:"mr-1 h-4 w-4"}),d(" 匯出請假 ")]),_:1})])]),a("div",$e,[a("div",Ie,[t(e(C),{variant:"danger",type:"button",class:"m-3",disabled:"",onClick:T},{default:s(()=>[t(e(k),{icon:"Download",class:"mr-1 h-4 w-4"}),d(" 請假匯入範例 ")]),_:1})])])]),a("div",Le,[t(e(o),{class:"-mt-2 border-separate border-spacing-y-[10px]"},{default:s(()=>[t(e(o).Thead,null,{default:s(()=>[t(e(o).Tr,null,{default:s(()=>[t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d("員工編號")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d("姓名")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d(" 假勤項目 ")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d("開始時間")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d("結束時間")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d(" 休息時間(小時) ")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d(" 時數（小時） ")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d(" 原因備註 ")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d("動作")]),_:1})]),_:1})]),_:1}),t(e(o).Tbody,null,{default:s(()=>[(w(!0),I(B,null,N(e(u),(l,L)=>(w(),E(e(o).Tr,{key:L,class:"intro-x"},{default:s(()=>[t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",Se,p(l.employeeId),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",De,p(l.userName),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",Ee,p(l.leaveName),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",Ne,p(l.startTime),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",Be,p(l.endTime),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",Me,p(l.restHours),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",je,p(((e(R)(l.endTime).diff(e(R)(l.startTime),"minute")-l.restHours)/60).toFixed(2)),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",He,p(l.description),1)]),_:2},1024),t(e(o).Td,{class:"relative w-56 border-b-0 bg-white py-0 shadow-[20px_3px_20px_#0000000b] before:absolute before:inset-y-0 before:left-0 before:my-auto before:block before:h-8 before:w-px before:bg-slate-200 first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600 before:dark:bg-darkmode-400"},{default:s(()=>[a("div",Pe,[t(e(C),{variant:"primary",type:"button",class:"m-3 w-20",onClick:H=>x(L)},{default:s(()=>[t(e(k),{icon:"Edit",class:"mr-1 h-4 w-4"}),d(" 修改 ")]),_:2},1032,["onClick"]),t(e(C),{variant:"danger",type:"button",class:"m-3 w-20",onClick:H=>U(l.id)},{default:s(()=>[t(e(k),{icon:"Trash",class:"mr-1 h-4 w-4"}),d(" 刪除 ")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),b.value?(w(),E(e(fe),{key:0,userLeave:v.value,onClose:_[1]||(_[1]=l=>b.value=!1),idx:m.value},null,8,["userLeave","idx"])):te("",!0)]))}});export{Xe as default};

import{T as i}from"./index-aiEbVBin.js";import{u as M,r as A,t as G,b as U,d as O,e as X,R as P,i as E,g as R,o as k,j as I,k as s,s as t,m as a,n,p as L,q as e,_ as V,v as T,c as S,A as z,F,x as D,z as $,D as j,E as J,G as K,h as B,w as Q,y as W}from"./index-oBWQfhjf.js";import{_ as C,a as Y}from"./FormSelect.vue_vue_type_script_setup_true_lang-WwyZrRan.js";import{_ as N}from"./FormDatepicker.vue_vue_type_script_setup_true_lang-SjeT_L7l.js";import{u as Z}from"./useLeave-1eEi6SK4.js";import"./_plugin-vue_export-helper-x3n3nnut.js";function ee(v){const{companyId:o}=M(),r=A({userId:"1",companyId:o.value??1,startTime:"",endTime:"",restHours:0,leaveId:"",description:""}),{userId:w,startTime:u,endTime:m,restHours:p,leaveId:b,description:y}=G(r),f=U(()=>!!v);O(()=>{const d={};if(v){const h={...v,...d};Object.keys(r).forEach(g=>{h[g]!==void 0&&(r[g]=h[g])})}});const _=U(()=>{var d;return w.value!==""&&((d=o.value)==null?void 0:d.toString())!==""&&u.value!==""&&m.value!==""&&b.value!==""&&p.value.toString()!==""&&p.value>=0});return{userId:w,companyId:o,startTime:u,endTime:m,restHours:p,leaveId:b,description:y,canSubmit:_,isEdit:f,submit:async(d,h)=>{const g=d?"update":"create";console.log(g),await{create:()=>E.post("/salary/user-leave",{...r}),update:()=>E.patch(`/salary/user-leave/${v.id}`,{...r,id:v.id})}[g](),X().showSaveSuccess(),h(),P().fetchUserLeaveList({companyId:o.value??1,page:1})}}}const te={class:"relative mb-5 text-center text-xl"},se={class:"mb-4 flex items-center"},ae=["value"],le={class:"mb-4 flex items-center"},oe={class:"mb-4 flex items-center"},ne={class:"mb-4 flex items-center"},re={class:"mb-4 flex items-center"},de={class:"flex justify-center"},ie=R({__name:"CreateUserLeaveModal",props:{userLeave:{},idx:{}},emits:["close"],setup(v,{emit:o}){const{companyId:r}=M(),{leaveList:w}=Z(r.value??1),u=o,{userLeave:m}=v,{startTime:p,endTime:b,leaveId:y,restHours:f,description:_,canSubmit:x,isEdit:d,submit:h}=ee(m);return(g,l)=>(k(),I(e(j),{open:!0,size:"md"},{default:s(()=>[t(e(j).Panel,{class:"p-4 md:w-[600px]"},{default:s(()=>[a("div",te,[n(L(e(d)?"編輯請假申請":"請假申請")+" ",1),t(e(V),{icon:"X",class:"absolute right-0 top-0 cursor-pointer text-[#939393]",onClick:l[0]||(l[0]=()=>u("close"))})]),a("section",null,[a("div",se,[t(e(C),{class:"w-[120px]"},{default:s(()=>[n("假別 *")]),_:1}),t(e(Y),{class:"flex-1",modelValue:e(y),"onUpdate:modelValue":l[1]||(l[1]=c=>T(y)?y.value=c:null)},{default:s(()=>[(k(!0),S(F,null,z(e(w),(c,q)=>(k(),S("option",{key:q,value:c.id},L(c.name),9,ae))),128))]),_:1},8,["modelValue"])]),a("div",le,[t(e(C),{class:"w-[120px]"},{default:s(()=>[n("起始時間 *")]),_:1}),t(N,{class:"flex-1",modelValue:e(p),"onUpdate:modelValue":l[2]||(l[2]=c=>T(p)?p.value=c:null),detail:"","time-picker-inline":""},null,8,["modelValue"])]),a("div",oe,[t(e(C),{class:"w-[120px]"},{default:s(()=>[n("結束時間 *")]),_:1}),t(N,{class:"flex-1",modelValue:e(b),"onUpdate:modelValue":l[3]||(l[3]=c=>T(b)?b.value=c:null),detail:"","time-picker-inline":""},null,8,["modelValue"])]),a("div",ne,[t(e(C),{class:"w-[120px]"},{default:s(()=>[n("休息時間 (小時) *")]),_:1}),t(e(D),{class:"flex-1",type:"number",min:"0",modelValue:e(f),"onUpdate:modelValue":l[4]||(l[4]=c=>T(f)?f.value=c:null),step:"0.1"},null,8,["modelValue"])]),a("div",re,[t(e(C),{class:"w-[120px]"},{default:s(()=>[n("原因備註")]),_:1}),t(e(D),{class:"flex-1",type:"text",modelValue:e(_),"onUpdate:modelValue":l[5]||(l[5]=c=>T(_)?_.value=c:null)},null,8,["modelValue"])]),a("div",de,[t(e($),{class:"mr-2 flex-1",variant:"primary",onClick:l[6]||(l[6]=()=>e(h)(e(d),()=>u("close"))),disabled:!e(x)},{default:s(()=>[n(L(e(d)?"儲存":"申請"),1)]),_:1},8,["disabled"])])])]),_:1})]),_:1}))}});function H(v){const o=P(),{fetchUserLeaveList:r}=o,w=U(()=>o.userLeave),u=(m,p)=>{J().showModal({deleteType:"userLeave",title:K.global.t("delete-alert-title"),content:"確定要刪除這筆資料嗎？刪除後無法復原，需要重新新增",deleteData:{companyId:m,id:p}})};return r({companyId:v,page:1}),{userLeaveList:w,confirmDeleteUserLeave:u,fetchUserLeaveList:r}}const ce={class:"flex justify-between"},ue={class:"intro-y col-span-12 mt-2 flex flex-wrap items-center sm:flex-nowrap"},me={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},pe={class:"relative text-slate-500"},fe={class:"mt-5 grid grid-cols-12 gap-6"},ve={class:"intro-y col-span-12 flex flex-wrap items-center sm:flex-nowrap"},_e={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},be={class:"relative text-slate-500"},xe={class:"intro-y col-span-12 overflow-auto lg:overflow-visible"},we={class:"font-medium"},he={class:"font-medium"},ye={class:"font-medium"},ge={class:"flex items-center justify-center"},Ue=R({__name:"UserLeavePage",setup(v){const{companyId:o}=M(),{userLeaveList:r,confirmDeleteUserLeave:w}=H(o.value??1),u=B(!1),m=B(-1);Q(o,()=>{H(o.value??1)});const p=U(()=>r.value[m.value]||null),b=f=>{m.value=-1,f!==void 0&&(m.value=f),u.value=!0},y=f=>{w(o.value??1,f)};return(f,_)=>(k(),S("div",null,[a("div",ce,[a("div",ue,[a("div",me,[a("div",pe,[t(e(D),{type:"text",class:"!box w-56 pr-10",placeholder:"Search..."}),t(e(V),{icon:"Search",class:"absolute inset-y-0 right-0 my-auto mr-3 h-4 w-4"})])])])]),a("div",fe,[a("div",ve,[a("div",_e,[a("div",be,[t(e($),{variant:"primary",type:"button",class:"m-3",onClick:_[0]||(_[0]=x=>b())},{default:s(()=>[t(e(V),{icon:"Plus",class:"mr-1 h-4 w-4"}),n(" 新增幫助 ")]),_:1})])])]),a("div",xe,[t(e(i),{class:"-mt-2 border-separate border-spacing-y-[10px]"},{default:s(()=>[t(e(i).Thead,null,{default:s(()=>[t(e(i).Tr,null,{default:s(()=>[t(e(i).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[n("類別")]),_:1}),t(e(i).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[n("標題")]),_:1}),t(e(i).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[n("內容")]),_:1}),t(e(i).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[n("動作")]),_:1})]),_:1})]),_:1}),t(e(i).Tbody,null,{default:s(()=>[(k(!0),S(F,null,z(e(r),(x,d)=>(k(),I(e(i).Tr,{key:d,class:"intro-x"},{default:s(()=>[t(e(i).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",we,L(x.help_type),1)]),_:2},1024),t(e(i).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",he,L(x.title),1)]),_:2},1024),t(e(i).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",ye,L(x.content),1)]),_:2},1024),t(e(i).Td,{class:"relative w-56 border-b-0 bg-white py-0 shadow-[20px_3px_20px_#0000000b] before:absolute before:inset-y-0 before:left-0 before:my-auto before:block before:h-8 before:w-px before:bg-slate-200 first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600 before:dark:bg-darkmode-400"},{default:s(()=>[a("div",ge,[t(e($),{variant:"primary",type:"button",class:"m-3 w-20",onClick:h=>b(d)},{default:s(()=>[t(e(V),{icon:"Edit",class:"mr-1 h-4 w-4"}),n(" 修改 ")]),_:2},1032,["onClick"]),t(e($),{variant:"danger",type:"button",class:"m-3 w-20",onClick:h=>y(x.id)},{default:s(()=>[t(e(V),{icon:"Trash",class:"mr-1 h-4 w-4"}),n(" 刪除 ")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),u.value?(k(),I(e(ie),{key:0,userLeave:p.value,onClose:_[1]||(_[1]=x=>u.value=!1),idx:m.value},null,8,["userLeave","idx"])):W("",!0)]))}});export{Ue as default};

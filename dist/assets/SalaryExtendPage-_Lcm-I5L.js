import{T as o}from"./index-aiEbVBin.js";import{u as N,r as P,t as z,b as V,d as F,e as R,Q as j,i as M,g as B,o as S,j as E,k as a,s as t,m as s,n as d,p as w,q as e,_ as T,v as g,x as $,z as C,D as I,E as q,G as A,h as D,w as G,c as U,y as O,F as Q,A as X}from"./index-oBWQfhjf.js";import{_ as k,a as H}from"./FormSelect.vue_vue_type_script_setup_true_lang-WwyZrRan.js";import{_ as J}from"./FormDatepicker.vue_vue_type_script_setup_true_lang-SjeT_L7l.js";import"./_plugin-vue_export-helper-x3n3nnut.js";function K(p){const{companyId:i}=N(),r=P({companyId:i.value??1,userId:"1",type:"PLUS",name:"",description:"",amount:0,yearMonth:""}),{userId:v,type:u,name:c,description:b,amount:_,yearMonth:h}=z(r),x=V(()=>!!p);F(()=>{const y={};if(p){const l={...p,...y};Object.keys(r).forEach(n=>{l[n]!==void 0&&(r[n]=l[n])})}});const f=V(()=>v.value!==""&&u.value!==""&&c.value!==""&&_.value.toString()!==""&&_.value>=0&&h.value!=="");return{companyId:i,userId:v,type:u,name:c,description:b,amount:_,yearMonth:h,canSubmit:f,isEdit:x,submit:async(y,l)=>{const n=y?"update":"create";console.log(n),await{create:()=>M.post("/salary/salary-extend",{...r}),update:()=>M.patch(`/salary/salary-extend/${p.id}`,{...r,id:p.id})}[n](),R().showSaveSuccess(),l(),j().fetchSalaryExtendList({companyId:i.value??1,page:1})}}}const W={class:"relative mb-5 text-center text-xl"},Y={class:"mb-4 flex items-center"},Z={class:"mb-4 flex items-center"},ee={class:"mb-4 flex items-center"},te={class:"mb-4 flex items-center"},ae=s("option",{value:"PLUS"},"加項",-1),se=s("option",{value:"MINUS"},"減項",-1),le={class:"mb-4 flex items-center"},oe={class:"flex justify-center"},de=B({__name:"CreateSalaryExtendModal",props:{salaryExtend:{},idx:{}},emits:["close"],setup(p,{emit:i}){const r=i,{salaryExtend:v}=p,{name:u,description:c,type:b,amount:_,yearMonth:h,canSubmit:x,isEdit:f,submit:m}=K(v);return(y,l)=>(S(),E(e(I),{open:!0,size:"md"},{default:a(()=>[t(e(I).Panel,{class:"p-4 md:w-[600px]"},{default:a(()=>[s("div",W,[d(w(e(f)?"編輯科別加減項":"新增科別加減項")+" ",1),t(e(T),{icon:"X",class:"absolute right-0 top-0 cursor-pointer text-[#939393]",onClick:l[0]||(l[0]=()=>r("close"))})]),s("section",null,[s("div",Y,[t(e(k),{class:"w-[120px]"},{default:a(()=>[d("薪資年月 *")]),_:1}),t(e(J),{class:"flex-1",modelValue:e(h),"onUpdate:modelValue":l[1]||(l[1]=n=>g(h)?h.value=n:null),"month-picker":"","auto-apply":""},null,8,["modelValue"])]),s("div",Z,[t(e(k),{class:"w-[120px]"},{default:a(()=>[d("薪資科目 *")]),_:1}),t(e($),{class:"flex-1",type:"text",modelValue:e(u),"onUpdate:modelValue":l[2]||(l[2]=n=>g(u)?u.value=n:null)},null,8,["modelValue"])]),s("div",ee,[t(e(k),{class:"w-[120px]"},{default:a(()=>[d("金額 *")]),_:1}),t(e($),{class:"flex-1",type:"number",min:"0",step:"1",modelValue:e(_),"onUpdate:modelValue":l[3]||(l[3]=n=>g(_)?_.value=n:null),onkeyup:"value=value.replace(/^(0+)|[^\\d]+/g,'')"},null,8,["modelValue"])]),s("div",te,[t(e(k),{class:"w-[120px]"},{default:a(()=>[d("加減項 *")]),_:1}),t(e(H),{class:"flex-1",type:"text",modelValue:e(b),"onUpdate:modelValue":l[4]||(l[4]=n=>g(b)?b.value=n:null)},{default:a(()=>[ae,se]),_:1},8,["modelValue"])]),s("div",le,[t(e(k),{class:"w-[120px]"},{default:a(()=>[d("備註")]),_:1}),t(e($),{class:"flex-1",type:"text",modelValue:e(c),"onUpdate:modelValue":l[5]||(l[5]=n=>g(c)?c.value=n:null)},null,8,["modelValue"])]),s("div",oe,[t(e(C),{class:"mr-2 flex-1",variant:"primary",onClick:l[6]||(l[6]=()=>e(m)(e(f),()=>r("close"))),disabled:!e(x)},{default:a(()=>[d(w(e(f)?"儲存":"新增"),1)]),_:1},8,["disabled"])])])]),_:1})]),_:1}))}});function L(p){const i=j(),{fetchSalaryExtendList:r}=i,v=V(()=>i.salaryExtend),u=(c,b)=>{q().showModal({deleteType:"salaryExtend",title:A.global.t("delete-alert-title"),content:"確定要刪除這筆資料嗎？刪除後無法復原，需要重新新增",deleteData:{companyId:c,id:b}})};return r({companyId:p,page:1}),{salaryExtendList:v,confirmDeleteSalaryExtend:u,fetchSalaryExtendList:r}}const ne={class:"flex justify-between"},re={class:"intro-y col-span-12 mt-2 flex flex-wrap items-center sm:flex-nowrap"},ie={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},ce={class:"relative text-slate-500"},ue={class:"mt-5 grid grid-cols-12 gap-6"},me={class:"intro-y col-span-12 flex flex-wrap items-center sm:flex-nowrap"},pe={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},_e={class:"relative text-slate-500"},fe={class:"intro-y col-span-12 overflow-auto lg:overflow-visible"},be={class:"font-medium"},xe={class:"font-medium"},ve={class:"font-medium"},he={class:"font-medium"},we={class:"font-medium"},ye={class:"font-medium"},ge={class:"flex items-center justify-center"},Ee=B({__name:"SalaryExtendPage",setup(p){const{companyId:i}=N(),{salaryExtendList:r,confirmDeleteSalaryExtend:v}=L(i.value??1),u=D(!1),c=D(-1);G(i,()=>{L(i.value??1)});const b=V(()=>r.value[c.value]||null),_=x=>{c.value=-1,x!==void 0&&(c.value=x),u.value=!0},h=x=>{v(i.value??1,x)};return(x,f)=>(S(),U("div",null,[s("div",ne,[s("div",re,[s("div",ie,[s("div",ce,[t(e($),{type:"text",class:"!box w-56 pr-10",placeholder:"Search..."}),t(e(T),{icon:"Search",class:"absolute inset-y-0 right-0 my-auto mr-3 h-4 w-4"})])])])]),s("div",ue,[s("div",me,[s("div",pe,[s("div",_e,[t(e(C),{variant:"primary",type:"button",class:"m-3",onClick:f[0]||(f[0]=m=>_())},{default:a(()=>[t(e(T),{icon:"Plus",class:"mr-1 h-4 w-4"}),d(" 新增儲值方案 ")]),_:1})])])]),s("div",fe,[t(e(o),{class:"-mt-2 border-separate border-spacing-y-[10px]"},{default:a(()=>[t(e(o).Thead,null,{default:a(()=>[t(e(o).Tr,null,{default:a(()=>[t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:a(()=>[d(" 退還點數 ")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:a(()=>[d("價錢")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:a(()=>[d("折扣")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:a(()=>[d("開始日期")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:a(()=>[d("結束日期")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:a(()=>[d("是否認證")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:a(()=>[d("創建時間")]),_:1})]),_:1})]),_:1}),t(e(o).Tbody,null,{default:a(()=>[(S(!0),U(Q,null,X(e(r),(m,y)=>(S(),E(e(o).Tr,{key:y,class:"intro-x"},{default:a(()=>[t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:a(()=>[s("div",be,w(m.redeem_point),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:a(()=>[s("div",xe,w(m.price),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:a(()=>[s("div",ve,w(m.discount),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:a(()=>[s("div",he,w(m.start_date),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:a(()=>[s("div",we,w(m.end_date),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:a(()=>[s("div",ye,w(m.valid),1)]),_:2},1024),t(e(o).Td,{class:"relative w-56 border-b-0 bg-white py-0 shadow-[20px_3px_20px_#0000000b] before:absolute before:inset-y-0 before:left-0 before:my-auto before:block before:h-8 before:w-px before:bg-slate-200 first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600 before:dark:bg-darkmode-400"},{default:a(()=>[s("div",ge,[t(e(C),{variant:"primary",type:"button",class:"m-3 w-20",onClick:l=>_(y)},{default:a(()=>[t(e(T),{icon:"Edit",class:"mr-1 h-4 w-4"}),d(" 修改 ")]),_:2},1032,["onClick"]),t(e(C),{variant:"danger",type:"button",class:"m-3 w-20",onClick:l=>h(m.id)},{default:a(()=>[t(e(T),{icon:"Trash",class:"mr-1 h-4 w-4"}),d(" 刪除 ")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),u.value?(S(),E(e(de),{key:0,salaryExtend:b.value,onClose:f[1]||(f[1]=m=>u.value=!1),idx:c.value},null,8,["salaryExtend","idx"])):O("",!0)]))}});export{Ee as default};

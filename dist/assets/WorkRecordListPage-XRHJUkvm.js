import{T as l}from"./index-hO9Hz3qR.js";import{p as K,q as P,c as D,s as q,v as E,O as U,y as H,d as j,o as C,i as S,w as s,f as t,e as o,g as d,t as p,h as e,l as w,E as O,A as $,b as W,n as F,F as N,m as A,_ as T,D as Y,L as z,M as X,r as L,j as G,K as M}from"./index-gJgnG53e.js";import{_ as I}from"./FormLabel.vue_vue_type_script_setup_true_lang-FtTE1i6h.js";import{_ as B}from"./FormDatepicker.vue_vue_type_script_setup_true_lang-6d158fgj.js";import{u as J}from"./useUser-1RWIge6k.js";function Q(_){const i=K({userId:"",companyId:"1",startTime:"",endTime:"",restHours:0,type:"HOLIDAY",description:""}),{userId:f,companyId:x,startTime:b,endTime:c,restHours:m,type:v,description:k}=P(i),y=D(()=>!!_);q(()=>{const h={};if(_){const n={..._,...h};Object.keys(i).forEach(u=>{n[u]!==void 0&&(i[u]=n[u])})}});const g=D(()=>f.value!==""&&x.value!==""&&b.value!==""&&c.value!==""&&v.value!==""&&m.value.toString()!==""&&m.value>=0);return{userId:f,companyId:x,startTime:b,endTime:c,restHours:m,type:v,description:k,canSubmit:g,isEdit:y,submit:async(h,n)=>{const u=h?"update":"create";if(i.restHours<0){E().showError({title:"休息時間需大於0",content:"休息時間需大於0"});return}await{create:()=>H.post("/salary/work-record",{...i}),update:()=>H.patch(`/salary/work-record/${_.id}`,{...i,id:_.id})}[u](),E().showSaveSuccess(),n(),U().fetchWorkRecordList({companyId:"1",page:1})}}}const Z={class:"relative mb-5 text-center text-xl"},ee={class:"mb-4 flex items-center"},te=["value"],se={class:"mb-4 flex items-center"},oe=o("option",{value:"HOLIDAY"},"例假日",-1),ae=o("option",{value:"OFFICIALHOLIDAY"},"國定假日",-1),le=o("option",{value:"RESTDAY"},"休息日",-1),de=o("option",{value:"WORKDAY"},"工作日",-1),re={class:"mb-4 flex items-center"},ne={class:"mb-4 flex items-center"},ie={class:"mb-4 flex items-center"},ce={class:"mb-4 flex items-center"},ue={class:"flex justify-center"},me=j({__name:"CreateWorkRecordModal",props:{workRecord:{},idx:{}},emits:["close"],setup(_,{emit:i}){const{users:f}=J(),x=i,{workRecord:b}=_,{userId:c,startTime:m,endTime:v,type:k,restHours:y,description:g,canSubmit:V,isEdit:h,submit:n}=Q(b);return(u,a)=>(C(),S(e(Y),{open:!0,size:"md"},{default:s(()=>[t(e(Y).Panel,{class:"p-4 md:w-[600px]"},{default:s(()=>[o("div",Z,[d(p(e(h)?"編輯加班/兼職":"加班/兼職申請")+" ",1),t(e(w),{icon:"X",class:"absolute right-0 top-0 cursor-pointer text-[#939393]",onClick:a[0]||(a[0]=()=>x("close"))})]),o("section",null,[o("div",ee,[t(e(I),{class:"w-[120px]"},{default:s(()=>[d("選擇員工 *")]),_:1}),t(e(O),{class:"flex-1",type:"text",modelValue:e(c),"onUpdate:modelValue":a[1]||(a[1]=r=>$(c)?c.value=r:null)},{default:s(()=>[(C(!0),W(N,null,F(e(f),(r,R)=>(C(),W("option",{key:R,value:r.id},p(r.name),9,te))),128))]),_:1},8,["modelValue"])]),o("div",se,[t(e(I),{class:"w-[120px]"},{default:s(()=>[d("選擇加班歸屬日")]),_:1}),t(e(O),{class:"flex-1",modelValue:e(k),"onUpdate:modelValue":a[2]||(a[2]=r=>$(k)?k.value=r:null)},{default:s(()=>[oe,ae,le,de]),_:1},8,["modelValue"])]),o("div",re,[t(e(I),{class:"w-[120px]"},{default:s(()=>[d("起始時間 *")]),_:1}),t(B,{class:"flex-1",modelValue:e(m),"onUpdate:modelValue":a[3]||(a[3]=r=>$(m)?m.value=r:null),detail:"","time-picker-inline":""},null,8,["modelValue"])]),o("div",ne,[t(e(I),{class:"w-[120px]"},{default:s(()=>[d("結束時間 *")]),_:1}),t(B,{class:"flex-1",modelValue:e(v),"onUpdate:modelValue":a[4]||(a[4]=r=>$(v)?v.value=r:null),detail:"","time-picker-inline":""},null,8,["modelValue"])]),o("div",ie,[t(e(I),{class:"w-[120px]"},{default:s(()=>[d("休息時間 (小時) *")]),_:1}),t(e(A),{class:"flex-1",type:"number",min:"0",modelValue:e(y),"onUpdate:modelValue":a[5]||(a[5]=r=>$(y)?y.value=r:null)},null,8,["modelValue"])]),o("div",ce,[t(e(I),{class:"w-[120px]"},{default:s(()=>[d("工作內容備註")]),_:1}),t(e(A),{class:"flex-1",type:"text",modelValue:e(g),"onUpdate:modelValue":a[6]||(a[6]=r=>$(g)?g.value=r:null)},null,8,["modelValue"])]),o("div",ue,[t(e(T),{class:"mr-2 flex-1",variant:"primary",onClick:a[7]||(a[7]=()=>e(n)(e(h),()=>x("close"))),disabled:!e(V)},{default:s(()=>[d(p(e(h)?"儲存":"申請"),1)]),_:1},8,["disabled"])])])]),_:1})]),_:1}))}});function pe(_){const i=U(),{fetchWorkRecordList:f}=i,x=D(()=>i.workRecordList),b=(c,m)=>{z().showModal({deleteType:"workRecord",title:X.global.t("delete-alert-title"),content:"確定要刪除這筆資料嗎？刪除後無法復原，需要重新新增",deleteData:{companyId:c,id:m}})};return f({companyId:_,page:1}),{workRecordList:x,confirmDeleteWorkRecord:b,fetchWorkRecordList:f}}const _e={class:"flex justify-between"},fe={class:"intro-y col-span-12 mt-2 flex flex-wrap items-center sm:flex-nowrap"},be={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},xe={class:"relative text-slate-500"},ve={class:"mt-5 grid grid-cols-12 gap-6"},he={class:"intro-y col-span-12 flex flex-wrap items-center sm:flex-nowrap"},we={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},ke={class:"relative text-slate-500"},ye={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},ge={class:"relative text-slate-500"},Te={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},Ce={class:"relative text-slate-500"},$e={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},Ie={class:"relative text-slate-500"},Ve={class:"intro-y col-span-12 overflow-auto lg:overflow-visible"},De={class:"font-medium"},We={class:"font-medium"},Re={class:"font-medium"},Le={class:"font-medium"},Se={class:"font-medium"},Ae={class:"font-medium"},Ee={class:"font-medium"},He={class:"font-medium"},Oe={class:"flex items-center justify-center"},Fe=j({__name:"WorkRecordListPage",setup(_){const i=L(1),{workRecordList:f,confirmDeleteWorkRecord:x}=pe("1"),b=L(!1),c=L(-1),m=D(()=>f.value[c.value]||null),v=n=>{c.value=-1,n!==void 0&&(c.value=n),b.value=!0},k=()=>{console.log("onExportWorkRecordClick")},y=()=>{console.log("onImportButtonClick")},g=()=>{console.log("onDownloadImportExampleClick")},V=n=>{x(i.value,n)},h=n=>({HOLIDAY:"例假日",OFFICIALHOLIDAY:"國定假日",RESTDAY:"休息日",WORKDAY:"工作日"})[n]||"null";return(n,u)=>(C(),W("div",null,[o("div",_e,[o("div",fe,[o("div",be,[o("div",xe,[t(e(A),{type:"text",class:"!box w-56 pr-10",placeholder:"Search..."}),t(e(w),{icon:"Search",class:"absolute inset-y-0 right-0 my-auto mr-3 h-4 w-4"})])])])]),o("div",ve,[o("div",he,[o("div",we,[o("div",ke,[t(e(T),{variant:"primary",type:"button",class:"m-3",onClick:u[0]||(u[0]=a=>v())},{default:s(()=>[t(e(w),{icon:"Plus",class:"mr-1 h-4 w-4"}),d(" 加班/兼職申請 ")]),_:1})])]),o("div",ye,[o("div",ge,[t(e(T),{variant:"primary",type:"button",class:"m-3",disabled:"",onClick:y},{default:s(()=>[t(e(w),{icon:"Upload",class:"mr-1 h-4 w-4"}),d(" 匯入加班/出勤 ")]),_:1})])]),o("div",Te,[o("div",Ce,[t(e(T),{variant:"primary",type:"button",class:"m-3",disabled:"",onClick:k},{default:s(()=>[t(e(w),{icon:"Download",class:"mr-1 h-4 w-4"}),d(" 匯出加班/出勤 ")]),_:1})])]),o("div",$e,[o("div",Ie,[t(e(T),{variant:"danger",type:"button",class:"m-3",disabled:"",onClick:g},{default:s(()=>[t(e(w),{icon:"Download",class:"mr-1 h-4 w-4"}),d(" 加班/兼職匯入範例 ")]),_:1})])])]),o("div",Ve,[t(e(l),{class:"-mt-2 border-separate border-spacing-y-[10px]"},{default:s(()=>[t(e(l).Thead,null,{default:s(()=>[t(e(l).Tr,null,{default:s(()=>[t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d("員工編號")]),_:1}),t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d("姓名")]),_:1}),t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d(" 加班歸屬日 ")]),_:1}),t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d("開始時間")]),_:1}),t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d("結束時間")]),_:1}),t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d(" 休息時間(小時) ")]),_:1}),t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d(" 時數（小時） ")]),_:1}),t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d(" 工作內容備註 ")]),_:1}),t(e(l).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[d("動作")]),_:1})]),_:1})]),_:1}),t(e(l).Tbody,null,{default:s(()=>[(C(!0),W(N,null,F(e(f),(a,r)=>(C(),S(e(l).Tr,{key:r,class:"intro-x"},{default:s(()=>[t(e(l).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",De,p(a.employeeId),1)]),_:2},1024),t(e(l).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",We,p(a.userName),1)]),_:2},1024),t(e(l).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Re,p(h(a.type)),1)]),_:2},1024),t(e(l).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Le,p(a.startTime),1)]),_:2},1024),t(e(l).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Se,p(a.endTime),1)]),_:2},1024),t(e(l).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Ae,p(a.restHours),1)]),_:2},1024),t(e(l).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",Ee,p(e(M)(a.endTime).diff(e(M)(a.startTime),"hour")-a.restHours),1)]),_:2},1024),t(e(l).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[o("div",He,p(a.description),1)]),_:2},1024),t(e(l).Td,{class:"relative w-56 border-b-0 bg-white py-0 shadow-[20px_3px_20px_#0000000b] before:absolute before:inset-y-0 before:left-0 before:my-auto before:block before:h-8 before:w-px before:bg-slate-200 first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600 before:dark:bg-darkmode-400"},{default:s(()=>[o("div",Oe,[t(e(T),{variant:"primary",type:"button",class:"m-3 w-20",onClick:R=>v(r)},{default:s(()=>[t(e(w),{icon:"Edit",class:"mr-1 h-4 w-4"}),d(" 修改 ")]),_:2},1032,["onClick"]),t(e(T),{variant:"danger",type:"button",class:"m-3 w-20",onClick:R=>V(a.id)},{default:s(()=>[t(e(w),{icon:"Trash",class:"mr-1 h-4 w-4"}),d(" 刪除 ")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),b.value?(C(),S(e(me),{key:0,workRecord:m.value,onClose:u[1]||(u[1]=a=>b.value=!1),idx:c.value},null,8,["workRecord","idx"])):G("",!0)]))}});export{Fe as default};

import{m as q,n as G,c as T,p as X,z as A,q as H,s as J,v as P,A as K,B as Q,C as U,E as W,d as I,o as k,g as $,w as s,G as B,e as a,j as l,t as h,u as e,f as t,i as g,x as D,y as E,k as V,_ as y,h as O,S as N,D as j,r as z,b as L,F,l as Y}from"./index-V2znHqRU.js";import{T as o}from"./index-v9gzeoX3.js";import{_ as M}from"./FormLabel.vue_vue_type_script_setup_true_lang-xTS_hXeG.js";function Z(r){const i=q({account:"",name:"",password:"",notifyType:20,notifyEmail:"",notifyPhone:"",phoneCode:"+886"}),{account:v,name:m,password:b,notifyType:c,notifyEmail:p,notifyPhone:_,phoneCode:f}=G(i),d=T(()=>!!r);X(()=>{const x={};if(r){if(r.notifyType===10){const{phoneCode:n,phone:w}=A(r.notifyPhone);x.phoneCode=`+${n}`,x.notifyPhone=w}r.notifyType===0&&(x.notifyType="none");const u={...r,...x};Object.keys(i).forEach(n=>{u[n]!==void 0&&(i[n]=u[n])})}});const C=T(()=>d.value?v.value!==""&&m.value!==""&&(c.value===20&&p.value!==""||c.value===10&&_.value!==""||c.value==="none"):v.value!==""&&m.value!==""&&b.value!==""&&(c.value===20&&p.value!==""||c.value===10&&_.value!==""||c.value==="none"));return{account:v,name:m,password:b,notifyType:c,notifyEmail:p,notifyPhone:_,phoneCode:f,canSubmit:C,isEdit:d,submit:async(x,u)=>{await{create:()=>P.post("user/subAccount",{...i,...c.value===10&&{notifyPhone:`${i.phoneCode}${i.notifyPhone}`}}),update:()=>P.put(`user/subAccount/${r.id}`,{...i,id:r.id,type:i.notifyType,...c.value===10&&{notifyPhone:`${i.phoneCode}${i.notifyPhone}`}})}[x?"update":"create"](),H().showSaveSuccess(),u(),J().fetchCompanies()}}}const ee=K("users",{state:()=>({users:[]}),actions:{fetchUsers(){P.get("/admin/user",{params:{page:0,pageSize:100}}).then(r=>{this.users=r.data.data})},deleteUser(r){P.delete(`/user/${r}`).then(()=>{this.fetchUsers()})}}});function R(){const r=ee(),{fetchUsers:i}=r,v=T(()=>r.users),m=c=>{Q().showModal({deleteType:"company",title:U.global.t("delete-alert-title"),content:U.global.t("page-delete-check-desc"),deleteData:{id:c}})},b=()=>{W().showModal({title:U.global.t("新增成功"),content:U.global.t("是否要前往計算薪資？"),confirmButtonText:"前往計算薪資"})};return i(),{users:v,fetchUsers:i,confirmDeleteCompany:m,confirmLinkSalary:b}}const te={class:"mb-4 flex items-center"},se={class:"mb-4 flex items-center"},ae={class:"mb-4 flex items-center"},oe={class:"flex justify-center"},le=I({__name:"CreateUserModal",props:{subAccount:{},idx:{}},emits:["close"],setup(r,{emit:i}){const{confirmLinkSalary:v}=R(),m=i,{subAccount:b}=r,{account:c,name:p,password:_,canSubmit:f,isEdit:d,submit:C}=Z(b),S=T(()=>d.value?N:j),x=T(()=>d.value?N.Panel:j.Panel);return(u,n)=>(k(),$(B(S.value),{open:!0,size:"md"},{default:s(()=>[(k(),$(B(x.value),{class:"p-4 md:w-[400px]"},{default:s(()=>[a("div",{class:D(["relative mb-5",e(d)?"text-primary":"text-center text-xl"])},[l(h(e(d)?u.$t("user-edit-model-title")+(u.idx+1):u.$t("user-create-model-title"))+" ",1),t(e(g),{icon:"X",class:"absolute right-0 top-0 cursor-pointer text-[#939393]",onClick:n[0]||(n[0]=()=>m("close"))})],2),a("div",te,[t(e(M),{class:"w-[120px]"},{default:s(()=>[l(h(u.$t("sub-account-name")),1)]),_:1}),t(e(V),{class:"flex-1",type:"text",placeholder:u.$t("signup-display-name-placeholder"),modelValue:e(p),"onUpdate:modelValue":n[1]||(n[1]=w=>E(p)?p.value=w:null)},null,8,["placeholder","modelValue"])]),a("div",se,[t(e(M),{class:"w-[120px]"},{default:s(()=>[l(h(u.$t("sub-account-account-label")),1)]),_:1}),t(e(V),{class:"flex-1",type:"text",placeholder:u.$t("error-message35"),modelValue:e(c),"onUpdate:modelValue":n[2]||(n[2]=w=>E(c)?c.value=w:null)},null,8,["placeholder","modelValue"])]),a("div",ae,[t(e(M),{class:"w-[120px]"},{default:s(()=>[l(h(e(d)?u.$t("edit-sub-account-pwd-label"):u.$t("sub-account-pwd-label")),1)]),_:1}),t(e(V),{class:"flex-1",type:"password",placeholder:u.$t("error-message36"),modelValue:e(_),"onUpdate:modelValue":n[3]||(n[3]=w=>E(_)?_.value=w:null)},null,8,["placeholder","modelValue"])]),a("div",oe,[e(d)?(k(),$(e(y),{key:0,variant:"outline-primary",onClick:n[4]||(n[4]=()=>m("close"))},{default:s(()=>[l(h(u.$t("cancel-btn")),1)]),_:1})):O("",!0),t(e(y),{style:{display:"none"},class:D({"flex-1":!e(d),"ml-3":e(d)}),disabled:!e(f),variant:"primary",onClick:n[5]||(n[5]=()=>e(C)(e(d),()=>m("close")))},{default:s(()=>[l(h(u.$t("save-btn")),1)]),_:1},8,["class","disabled"]),t(e(y),{class:D({"flex-1":!e(d),"ml-3":e(d)}),variant:"primary",onClick:n[6]||(n[6]=w=>e(v)())},{default:s(()=>[l(h(u.$t("save-btn")),1)]),_:1},8,["class"])])]),_:1}))]),_:1}))}}),de={class:"mt-5 grid grid-cols-12 gap-6"},ne={class:"intro-y col-span-12 mt-2 flex flex-wrap items-center sm:flex-nowrap"},re={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},ie={class:"relative text-slate-500"},ue={class:"intro-y col-span-12 mt-2 flex flex-wrap items-center sm:flex-nowrap"},ce={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},me={class:"relative text-slate-500"},pe={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},fe={class:"relative text-slate-500"},be={class:"mt-3 w-full sm:ml-auto sm:mt-0 sm:w-auto md:ml-0"},_e={class:"relative text-slate-500"},he={class:"intro-y col-span-12 overflow-auto lg:overflow-visible"},ve={class:"font-medium"},we={class:"font-medium"},xe={class:"font-medium"},ye={class:"font-medium"},ge=a("div",{class:"font-medium"},null,-1),ke=a("div",{class:"font-medium"},null,-1),Ce=a("div",{class:"font-medium"},null,-1),Te=a("div",{class:"font-medium"},null,-1),$e=a("div",{class:"font-medium"},null,-1),Se={class:"flex items-center justify-center"},De=I({__name:"User",setup(r){const{users:i,confirmDeleteCompany:v}=R(),m=z(!1),b=z(-1),c=T(()=>i.value[b.value]||null),p=_=>{b.value=-1,_!==void 0&&(b.value=_),m.value=!0};return(_,f)=>(k(),L(F,null,[a("div",de,[a("div",ne,[a("div",re,[a("div",ie,[t(e(V),{type:"text",class:"!box w-56 pr-10",placeholder:"Search..."}),t(e(g),{icon:"Search",class:"absolute inset-y-0 right-0 my-auto mr-3 h-4 w-4"})])])]),a("div",ue,[a("div",ce,[a("div",me,[t(e(y),{variant:"primary",type:"button",class:"m-3",onClick:f[0]||(f[0]=()=>p())},{default:s(()=>[t(e(g),{icon:"Plus",class:"mr-1 h-4 w-4"}),l(" 新增員工 ")]),_:1})])]),a("div",pe,[a("div",fe,[t(e(y),{variant:"primary",type:"button",class:"m-3",onClick:f[1]||(f[1]=()=>p())},{default:s(()=>[t(e(g),{icon:"Upload",class:"mr-1 h-4 w-4"}),l(" 匯入員工資料 ")]),_:1})])]),a("div",be,[a("div",_e,[t(e(y),{variant:"primary",type:"button",class:"m-3",onClick:f[2]||(f[2]=()=>p())},{default:s(()=>[t(e(g),{icon:"Download",class:"mr-1 h-4 w-4"}),l(" 匯出員工資料 ")]),_:1})])])]),a("div",he,[t(e(o),{class:"-mt-2 border-separate border-spacing-y-[10px]"},{default:s(()=>[t(e(o).Thead,null,{default:s(()=>[t(e(o).Tr,null,{default:s(()=>[t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("員工編號")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("姓名")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("Email")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("到職日")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("離職日")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("在職狀態")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("計薪方式")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("薪資總計")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("更新日期")]),_:1}),t(e(o).Th,{class:"whitespace-nowrap border-b-0"},{default:s(()=>[l("動作")]),_:1})]),_:1})]),_:1}),t(e(o).Tbody,null,{default:s(()=>[(k(!0),L(F,null,Y(e(i),(d,C)=>(k(),$(e(o).Tr,{key:C,class:"intro-x"},{default:s(()=>[t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",ve,h(d.id),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",we,h(d.name),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",xe,h(d.name),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[a("div",ye,h(d.taxId),1)]),_:2},1024),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[ge]),_:1}),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[ke]),_:1}),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[Ce]),_:1}),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[Te]),_:1}),t(e(o).Td,{class:"border-b-0 bg-white text-center shadow-[20px_3px_20px_#0000000b] first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600"},{default:s(()=>[$e]),_:1}),t(e(o).Td,{class:"relative w-56 border-b-0 bg-white py-0 shadow-[20px_3px_20px_#0000000b] before:absolute before:inset-y-0 before:left-0 before:my-auto before:block before:h-8 before:w-px before:bg-slate-200 first:rounded-l-md last:rounded-r-md dark:bg-darkmode-600 before:dark:bg-darkmode-400"},{default:s(()=>[a("div",Se,[t(e(y),{variant:"primary",type:"button",class:"m-3 w-20",onClick:S=>p(C)},{default:s(()=>[t(e(g),{icon:"Edit",class:"mr-1 h-4 w-4"}),l(" 修改 ")]),_:2},1032,["onClick"]),t(e(y),{variant:"danger",type:"button",class:"m-3 w-20",onClick:S=>e(v)(d.id)},{default:s(()=>[t(e(g),{icon:"Trash",class:"mr-1 h-4 w-4"}),l(" 刪除 ")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),m.value?(k(),$(e(le),{key:0,onClose:f[3]||(f[3]=d=>m.value=!1),company:c.value,idx:b.value},null,8,["company","idx"])):O("",!0)],64))}});export{De as default};
